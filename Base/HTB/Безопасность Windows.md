#windows #htb 

Безопасность — важнейшая тема для операционных систем Windows. В системах Windows много движущихся частей, которые представляют собой обширную поверхность атаки. Из-за множества встроенных приложений, функций и уровней настроек системы Windows можно легко неправильно настроить, что делает их уязвимыми для атак, даже если они полностью обновлены.

В нём есть множество встроенных функций, которыми можно злоупотреблять, и он страдает от множества критических уязвимостей, что приводит к появлению широко используемых и очень эффективных удалённых и локальных эксплойтов.

На протяжении многих лет Microsoft совершенствовала систему безопасности Windows. По мере того как наш мир становится всё более взаимосвязанным, а злоумышленники — всё более изощрёнными, Microsoft продолжает добавлять новые функции, которые системные администраторы могут использовать для защиты систем и активной блокировки и обнаружения попыток вторжения и неправомерного использования.

Windows использует определённые принципы безопасности для контроля доступа и аутентификации в системе. Эти принципы применяются к различным объектам, таким как пользователи, сетевые компьютеры, потоки и процессы, которые могут быть авторизованы для выполнения определённых действий. Модель безопасности разработана таким образом, чтобы свести к минимуму риск несанкционированного доступа, усложнив злоумышленникам или вредоносному ПО задачу по использованию системы.

---

## Идентификатор безопасности (SID)

Каждый из субъектов безопасности в системе имеет уникальный идентификатор безопасности (SID). Система автоматически генерирует SID. Это означает, что даже если, например, в системе есть два одинаковых пользователя, Windows может различать их и их права на основе SID. SID — это строковые значения разной длины, которые хранятся в базе данных безопасности. Эти SID добавляются к токену доступа пользователя для идентификации всех действий, которые пользователь имеет право выполнять.

SID состоит из идентификатора и относительного идентификатора (RID). В среде домена Active Directory (AD) SID также включает идентификатор домена.

  Безопасность Windows

```powershell-session
PS C:\htb> whoami /user

USER INFORMATION
----------------

User Name           SID
=================== =============================================
ws01\bob S-1-5-21-674899381-4069889467-2080702030-1002
```

SID разбит на этот шаблон.

  Безопасность Windows

```powershell-session
(SID)-(revision level)-(identifier-authority)-(subauthority1)-(subauthority2)-(etc)
```

Давайте разберем SID по частям.

|**Число**|**Значение**|**Описание**|
|---|---|---|
|S|СИД|Идентифицирует строку как SID.|
|1|Уровень ревизии|На сегодняшний день это никогда не менялось и так было всегда `1`.|
|5|Идентификатор-авторитет|48-битная строка, которая идентифицирует орган (компьютер или сеть), создавший SID.|
|21|Субавторитетность 1|Это переменный номер, который идентифицирует отношение пользователя или группы, описанной SID, к органу, который её создал. Он показывает, в каком порядке этот орган создал учётную запись пользователя.|
|674899381-4069889467-2080702030|Субавторитетность 2|Сообщает нам, на каком компьютере (или домене) был создан этот номер|
|1002|Субавторитет3|Идентификатор, который отличает одну учётную запись от другой. Указывает, является ли этот пользователь обычным пользователем, гостем, администратором или членом какой-либо другой группы|

---

## Менеджер учетных записей безопасности (SAM) и записей контроля доступа (ACE)

SAM предоставляет сети права на выполнение определенных процессов.

Сами права доступа управляются записями контроля доступа (ACE) в списках контроля доступа (ACL). Списки ACL содержат ACE, которые определяют, какие пользователи, группы или процессы имеют доступ к файлу или, например, к выполнению процесса.

Разрешения на доступ к защищаемому объекту предоставляются дескриптором безопасности, классифицируемым по двум типам списков управления доступом: `Discretionary Access Control List (DACL)` или `System Access Control List (SACL)`. Каждый поток и процесс, запущенный или инициированный пользователем, проходит процедуру авторизации. Неотъемлемой частью этого процесса являются токены доступа, проверяемые Локальным органом безопасности (LSA). Помимо идентификатора SID, эти маркеры доступа содержат другую информацию, касающуюся безопасности. Понимание этих функциональных возможностей является важной частью обучения использованию этих механизмов безопасности и обходу их на этапе повышения привилегий.

---

## Контроль учетных записей пользователей (UAC)

[Контроль учётных записей (UAC)](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works) — это функция безопасности в Windows, которая предотвращает запуск вредоносных программ или процессов, которые могут нанести вред компьютеру или его содержимому. В UAC есть режим одобрения администратором, который предназначен для предотвращения установки нежелательного программного обеспечения без ведома администратора или для предотвращения внесения изменений в систему. Наверняка вы уже видели запрос на подтверждение, если устанавливали какое-то программное обеспечение, и ваша система запрашивала подтверждение установки. Поскольку для установки требуются права администратора, появляется окно с вопросом, хотите ли вы подтвердить установку. Если у стандартного пользователя нет прав на установку, выполнение будет отклонено или вам будет предложено ввести пароль администратора. Это окно с запросом согласия прерывает выполнение скриптов или двоичных файлов, которые пытаются выполнить вредоносные программы или злоумышленники, до тех пор, пока пользователь не введёт пароль или не подтвердит выполнение. Чтобы понять, как работает UAC, нам нужно знать, как он устроен и как работает, а также что вызывает запрос согласия. Следующая схема, адаптированная из источника [здесь](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works), показывает, как работает UAC.

![Блок-схема взаимодействия пользователя и системы для запросов на повышение прав, удалённого управления и настроек UAC.](https://academy.hackthebox.com/storage/modules/49/uacarchitecture1.png)

---

## Реестр

[Реестр](https://en.wikipedia.org/wiki/Windows_Registry) — это иерархическая база данных в Windows, критически важная для операционной системы. В ней хранятся низкоуровневые настройки операционной системы Windows и приложений, которые используют её. Она разделена на данные, относящиеся к компьютеру, и данные, относящиеся к пользователю. Мы можем открыть редактор реестра, введя `regedit` в командной строке или в строке поиска Windows.

![Редактор реестра показывает HKEY_LOCAL_MACHINE с параметром Analysis DWORD, установленным на 0.](https://academy.hackthebox.com/storage/modules/49/regedit.png)

Древовидная структура состоит из основных папок (корневых ключей), в которых находятся подпапки (дочерние ключи) с их записями/файлами (значениями). Существует 11 различных типов значений, которые можно ввести в дочерний ключ.

|**Значение**|**Тип**|
|---|---|
|REG_BINARY|Двоичные данные в любой форме.|
|REG_DWORD|32-битное число.|
|REG_DWORD_LITTLE_ENDIAN|32-разрядное число в формате с прямым порядком байтов. Windows предназначена для работы на компьютерах с прямым порядком байтов. Поэтому в заголовочных файлах Windows это значение определяется как REG_DWORD.|
|REG_DWORD_BIG_ENDIAN|32-разрядное число в формате с прямым порядком байтов. Некоторые системы UNIX поддерживают архитектуры с прямым порядком байтов.|
|REG_EXPAND_SZ|Строка с завершающим нулём, содержащая неразвёрнутые ссылки на переменные среды (например, «%PATH%»). Это будет строка в кодировке Unicode или ANSI в зависимости от того, используете ли вы функции Unicode или ANSI. Чтобы развернуть ссылки на переменные среды, используйте функцию [**ExpandEnvironmentStrings**](https://docs.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-expandenvironmentstringsa).|
|REG_LINK ( РЕГУЛЯРНАЯ ССЫЛКА )|Строка Юникода с завершающим нулём, содержащая целевой путь символической ссылки, созданной с помощью функции [**RegCreateKeyEx**](https://docs.microsoft.com/en-us/windows/desktop/api/Winreg/nf-winreg-regcreatekeyexa) с параметром REG_OPTION_CREATE_LINK.|
|REG_MULTI_SZ|Последовательность строк с завершающим нулём, завершающаяся пустой строкой (\0). Ниже приведён пример: _Строка1_\0_Строка2_\0_Строка3_\0_ПоследняяСтрока_\0\0 Первый \0 завершает первую строку, предпоследний \0 завершает последнюю строку, а последний \0 завершает последовательность. Обратите внимание, что последний терминатор должен учитываться при определении длины строки.|
|REG_NONE|Нет определенного типа значения.|
|REG_QWORD|64-битное число.|
|REG_QWORD_LITTLE_ENDIAN|64-разрядное число в формате с прямым порядком байтов. Windows предназначена для работы на компьютерах с прямым порядком байтов. Поэтому в заголовочных файлах Windows это значение определяется как REG_QWORD.|
|REG_SZ|Строка с завершающим нулём. Это может быть строка в кодировке Unicode или ANSI, в зависимости от того, используете ли вы функции Unicode или ANSI.|

Источник: [https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry-value-types](https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry-value-types)

Каждая папка в `Computer` — это ключ. Все корневые ключи начинаются с `HKEY`. Ключ, например `HKEY-LOCAL-MACHINE`, сокращается до `HKLM`. HKLM содержит все настройки, относящиеся к локальной системе. Этот корневой ключ содержит шесть подразделов, таких как `SAM`, `SECURITY`, `SYSTEM`, `SOFTWARE`, `HARDWARE`, и `BCD`, которые загружаются в память во время загрузки (кроме `HARDWARE`, который загружается динамически).

![Редактор реестра показывает HKEY_LOCAL_MACHINE с параметром Analysis DWORD, установленным на 0.](https://academy.hackthebox.com/storage/modules/49/regedit2.png)

Весь системный реестр хранится в нескольких файлах операционной системы. Вы можете найти их в разделе `C:\Windows\System32\Config\`.

  Безопасность Windows

```powershell-session
PS C:\htb> ls

    Directory: C:\Windows\system32\config

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         12/7/2019   4:14 AM                Journal
d-----         12/7/2019   4:14 AM                RegBack
d-----         12/7/2019   4:14 AM                systemprofile
d-----         8/12/2020   1:43 AM                TxR
-a----         8/13/2020   6:02 PM        1048576 BBI
-a----         6/25/2020   4:36 PM          28672 BCD-Template
-a----         8/30/2020  12:17 PM       33816576 COMPONENTS
-a----         8/13/2020   6:02 PM         524288 DEFAULT
-a----         8/26/2020   7:51 PM        4603904 DRIVERS
-a----         6/25/2020   3:37 PM          32768 ELAM
-a----         8/13/2020   6:02 PM          65536 SAM
-a----         8/13/2020   6:02 PM          65536 SECURITY
-a----         8/13/2020   6:02 PM       87818240 SOFTWARE
-a----         8/13/2020   6:02 PM       17039360 SYSTEM
```

Раздел реестра для конкретного пользователя (HKCU) хранится в папке пользователя (т. е. `C:\Users\<USERNAME>\Ntuser.dat`).

  Безопасность Windows

```powershell-session
PS C:\htb> gci -Hidden

    Directory: C:\Users\bob

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d--h--         6/25/2020   5:12 PM                AppData
d--hsl         6/25/2020   5:12 PM                Application Data
d--hsl         6/25/2020   5:12 PM                Cookies
d--hsl         6/25/2020   5:12 PM                Local Settings
d--h--         6/25/2020   5:12 PM                MicrosoftEdgeBackups
d--hsl         6/25/2020   5:12 PM                My Documents
d--hsl         6/25/2020   5:12 PM                NetHood
d--hsl         6/25/2020   5:12 PM                PrintHood
d--hsl         6/25/2020   5:12 PM                Recent
d--hsl         6/25/2020   5:12 PM                SendTo
d--hsl         6/25/2020   5:12 PM                Start Menu
d--hsl         6/25/2020   5:12 PM                Templates
-a-h--         8/13/2020   6:01 PM        2883584 NTUSER.DAT
-a-hs-         6/25/2020   5:12 PM         524288 ntuser.dat.LOG1
-a-hs-         6/25/2020   5:12 PM        1011712 ntuser.dat.LOG2
-a-hs-         8/17/2020   5:46 PM        1048576 NTUSER.DAT{53b39e87-18c4-11ea-a811-000d3aa4692b}.TxR.0.regtrans-ms
-a-hs-         8/17/2020  12:13 PM        1048576 NTUSER.DAT{53b39e87-18c4-11ea-a811-000d3aa4692b}.TxR.1.regtrans-ms
-a-hs-         8/17/2020  12:13 PM        1048576 NTUSER.DAT{53b39e87-18c4-11ea-a811-000d3aa4692b}.TxR.2.regtrans-ms
-a-hs-         8/17/2020   5:46 PM          65536 NTUSER.DAT{53b39e87-18c4-11ea-a811-000d3aa4692b}.TxR.blf
-a-hs-         6/25/2020   5:15 PM          65536 NTUSER.DAT{53b39e88-18c4-11ea-a811-000d3aa4692b}.TM.blf
-a-hs-         6/25/2020   5:12 PM         524288 NTUSER.DAT{53b39e88-18c4-11ea-a811-000d3aa4692b}.TMContainer000000000
                                                  00000000001.regtrans-ms
-a-hs-         6/25/2020   5:12 PM         524288 NTUSER.DAT{53b39e88-18c4-11ea-a811-000d3aa4692b}.TMContainer000000000
                                                  00000000002.regtrans-ms
---hs-         6/25/2020   5:12 PM             20 ntuser.ini
```

---

## Разделы реестра Run и RunOnce

Существуют также так называемые разделы реестра, которые содержат логическую группу ключей, подключей и значений для поддержки программного обеспечения и файлов, загружаемых в память при запуске операционной системы или входе пользователя в систему. Эти разделы полезны для обеспечения доступа к системе. Они называются [ключами реестра Run и RunOnce](https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys).

Реестр Windows включает в себя следующие четыре ключа:

  Безопасность Windows

```powershell-session
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

Вот пример использования `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run` ключа при входе в систему.

  Безопасность Windows

```powershell-session
PS C:\htb> reg query HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
    SecurityHealth    REG_EXPAND_SZ    %windir%\system32\SecurityHealthSystray.exe
    RTHDVCPL    REG_SZ    "C:\Program Files\Realtek\Audio\HDA\RtkNGUI64.exe" -s
    Greenshot    REG_SZ    C:\Program Files\Greenshot\Greenshot.exe
```

Вот пример того, как `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` показывает приложения, запущенные от имени текущего пользователя при входе в систему.

  Безопасность Windows

```powershell-session
PS C:\htb> reg query HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
    OneDrive    REG_SZ    "C:\Users\bob\AppData\Local\Microsoft\OneDrive\OneDrive.exe" /background
    OPENVPN-GUI    REG_SZ    C:\Program Files\OpenVPN\bin\openvpn-gui.exe
    Docker Desktop    REG_SZ    C:\Program Files\Docker\Docker\Docker Desktop.exe
```

---

## Включение приложения в Белый список

Белый список приложений — это список одобренных программных приложений или исполняемых файлов, которым разрешено присутствовать в системе и работать в ней. Цель состоит в том, чтобы защитить среду от вредоносных программ и неодобренных приложений, которые не соответствуют конкретным бизнес-потребностям организации. Внедрение принудительного белого списка может быть непростой задачей, особенно в крупной сети. Организации следует изначально внедрять белый список в режиме аудита, чтобы убедиться, что все необходимые приложения включены в белый список и не заблокированы по ошибке, которая может вызвать больше проблем, чем решить.

Чёрный список, напротив, определяет список вредоносного или запрещённого программного обеспечения/приложений для блокировки, а все остальные программы/приложения могут работать/устанавливаться. Белый список основан на принципе «нулевого доверия», согласно которому все программы/приложения считаются «плохими», за исключением тех, которые разрешены. Ведение белого списка, как правило, требует меньше усилий, поскольку системному администратору нужно только указать, что разрешено, а не постоянно обновлять «чёрный список» новыми вредоносными приложениями.

Белый список рекомендуется такими организациями, как [NIST](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-167.pdf), особенно в средах с высоким уровнем безопасности.

---

## Блокировщик приложений

[AppLocker](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview) — это решение Microsoft для добавления приложений в белый список, впервые представленное в Windows 7. AppLocker позволяет системным администраторам контролировать, какие приложения и файлы могут запускать пользователи. Он обеспечивает детальный контроль над исполняемыми файлами, сценариями, файлами установщиков Windows, библиотеками DLL, упакованными приложениями и установщиками упакованных приложений.

Это позволяет создавать правила на основе таких атрибутов файлов, как имя издателя (которое можно получить из цифровой подписи), название продукта, имя файла и версия. Правила также можно настроить на основе путей к файлам и хэшей. Правила можно применять как к группам безопасности, так и к отдельным пользователям в зависимости от потребностей бизнеса. Сначала AppLocker можно развернуть в режиме аудита, чтобы проверить влияние на работу, прежде чем применять все правила.

---

## Локальная Групповая политика

Групповая политика позволяет администраторам устанавливать, настраивать и изменять различные параметры. В доменной среде групповые политики распространяются с контроллера домена на все компьютеры, подключенные к домену, с которыми связаны объекты групповой политики (GPO). Эти параметры также можно задать на отдельных компьютерах с помощью локальной групповой политики.

Групповую политику можно настроить локально как в доменных, так и в недоменных средах. Локальную групповую политику можно использовать для настройки определённых графических и сетевых параметров, которые иначе недоступны через панель управления. Её также можно использовать для блокировки политики отдельного компьютера с помощью строгих настроек безопасности, например, для разрешения установки/запуска только определённых программ или для применения строгих требований к паролям учётных записей пользователей.

Мы можем открыть редактор локальной групповой политики, открыв меню «Пуск» и введя `gpedit.msc`. Редактор разделён на две категории в разделе «Локальная политика компьютера» — `Computer Configuration` и `User Configuration`.

![Редактор локальной групповой политики, показывающий административные шаблоны в разделе "Конфигурация компьютера".](https://academy.hackthebox.com/storage/modules/49/Local_GP.png)

Например, мы можем открыть «Политику локального компьютера», чтобы включить защиту учётных данных, активировав параметр `Turn On Virtualization Based Security`. Защита учётных данных — это функция Windows 10, которая защищает от атак с использованием учётных данных, изолируя процесс LSA операционной системы.

![Включите окно настроек безопасности на основе виртуализации с параметрами для включения безопасной загрузки и защиты DMA.](https://academy.hackthebox.com/storage/modules/49/credguard.png)

Мы также можем включить расширенный аудит учётных записей и настроить AppLocker в редакторе локальной групповой политики. Стоит изучить локальную групповую политику и узнать о широком спектре способов, с помощью которых можно заблокировать систему Windows.

---

## Антивирус Защитника Windows

Антивирус Защитника Windows (Defender), ранее известный как Защитник Windows, — это встроенный антивирус, который бесплатно поставляется с операционными системами Windows. Впервые он был выпущен как загружаемый инструмент для защиты от шпионских программ для Windows XP и Server 2003. Защитник стал поставляться в составе операционной системы с Windows Vista/Server 2008. Программа была переименована в Антивирус Защитника Windows в обновлении Windows 10 Creators Update.

Защитник поставляется с несколькими функциями, такими как защита в реальном времени, которая защищает устройство от известных угроз в режиме реального времени, и облачная защита, которая работает в сочетании с автоматической отправкой образцов для загрузки подозрительных файлов для анализа. Когда файлы отправляются в службу облачной защиты, они «блокируются» для предотвращения потенциально вредоносного поведения до завершения анализа. Ещё одна функция — защита от несанкционированного доступа, которая предотвращает изменение настроек безопасности с помощью реестра, командлетов PowerShell или групповой политики.

Защитником Windows можно управлять из Центра безопасности, где можно включить и настроить различные дополнительные функции и параметры безопасности.

![На панели управления безопасностью Windows отображается состояние отключённой защиты от вирусов, включённой защиты учётной записи и отключённого брандмауэра.](https://academy.hackthebox.com/storage/modules/49/Defender_sec_center.png)

Настройки защиты в реальном времени можно изменить, чтобы добавить файлы, папки и области памяти в список контролируемого доступа к папкам для предотвращения несанкционированных изменений. Мы также можем добавить файлы или папки в список исключений, чтобы они не сканировались. Например, можно исключить из сканирования папку с инструментами, используемыми для тестирования на проникновение, так как они будут помечены как вредоносные и помещены в карантин или удалены из системы. Контролируемый доступ к папкам — это встроенная в Защитник функция защиты от программ-вымогателей.

Мы можем использовать командлет PowerShell `Get-MpComputerStatus` для проверки, какие параметры защиты включены.

  Безопасность Windows

```powershell-session
PS C:\htb> Get-MpComputerStatus | findstr "True"
AMServiceEnabled                : True
AntispywareEnabled              : True
AntivirusEnabled                : True
BehaviorMonitorEnabled          : True
IoavProtectionEnabled           : True
IsTamperProtected               : True
NISEnabled                      : True
OnAccessProtectionEnabled       : True
RealTimeProtectionEnabled       : True
```

Хотя ни одно антивирусное решение не является идеальным, Защитник Windows показывает очень хорошие результаты в ежемесячных тестах на уровень обнаружения по сравнению с другими решениями, даже платными. Кроме того, поскольку он предустановлен как часть операционной системы, он не «раздувает» систему, как другие программы, добавляющие расширения для браузеров и трекеры. Известно, что другие продукты замедляют работу системы из-за того, как они подключаются к операционной системе.

Защитник Windows не лишён недостатков и должен быть частью стратегии многоуровневой защиты, основанной на основных принципах настройки и управления исправлениями, а не рассматриваться как панацея для защиты наших систем. Определения постоянно обновляются, а новые версии Защитника Windows встроены в основные выпуски операционных систем, такие как Windows 10 версии 1909, которая является самой последней версией на момент написания статьи.

Защитник Windows обнаружит вредоносные программы из распространённых фреймворков с открытым исходным кодом, таких как Metasploit, или неизменённые версии таких инструментов, как Mimikatz.

![В истории защиты показано, что брандмауэры отключены и обнаружена серьёзная угроза: Trojan.Win32/Meterpreter.O.](https://academy.hackthebox.com/storage/modules/49/meterp_caught.png)

Хотя это становится всё более сложной задачей, всё ещё можно полностью обойти защиту Windows Defender, установленную в последней версии с самыми актуальными определениями. 

## Практика

Давайте рассмотрим команды PowerShell, которые используются для получения SID пользователя по его имени:

powershell

`$objUser = New-Object System.Security.Principal.NTAccount("Jim") $strSID = $objUser.Translate([System.Security.Principal.SecurityIdentifier]) $strSID.Value`

## Объяснение команд:

1. **`$objUser = New-Object System.Security.Principal.NTAccount("bob.smith")`**:
    
    - Эта команда создаёт новый объект класса `NTAccount`, который представляет собой учётную запись в системе Windows.
        
    - В скобках указывается имя пользователя (`"bob.smith"`). Если имя пользователя не содержит домена, PowerShell попытается найти пользователя в текущем домене или на локальном компьютере.
        
2. **`$strSID = $objUser.Translate([System.Security.Principal.SecurityIdentifier])`**:
    
    - Эта команда преобразует объект `NTAccount` в объект `SecurityIdentifier`, который содержит SID пользователя.
        
    - Метод `Translate` используется для преобразования имени пользователя в его SID.
        
3. **`$strSID.Value`**:
    
    - Эта команда выводит значение SID пользователя в виде строки.
        
    - Свойство `Value` объекта `SecurityIdentifier` возвращает SID в формате `S-1-5-21-...`.
        

## Примечания:

- Если пользователь находится в домене, его имя должно быть указано в формате `DOMAIN\username` или `username@domain.com`, чтобы PowerShell мог правильно определить домен.
    
- Если пользователь является локальным, его имя должно быть указано без домена, или можно указать имя компьютера в качестве домена (например, `COMPUTERNAME\username`).
    
- Если пользователь не найден, PowerShell выдаст ошибку. Поэтому перед выполнением команды убедитесь, что пользователь существует в системе или домене.
    

### Citations:

1. [https://iteron.ru/%D0%BA%D0%B0%D0%BA-%D1%83%D0%B7%D0%BD%D0%B0%D1%82%D1%8C-sid-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%BF%D0%BE-%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8-%D0%B8-%D0%BD%D0%B0/](https://iteron.ru/%D0%BA%D0%B0%D0%BA-%D1%83%D0%B7%D0%BD%D0%B0%D1%82%D1%8C-sid-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%BF%D0%BE-%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8-%D0%B8-%D0%BD%D0%B0/)
2. [https://fixmypc.ru/post/poisk-sid-v-powershell-polzovatelei-i-grupp/](https://fixmypc.ru/post/poisk-sid-v-powershell-polzovatelei-i-grupp/)
3. [https://winitpro.ru/index.php/2016/05/27/kak-uznat-sid-polzovatelya-po-imeni-i-naoborot/](https://winitpro.ru/index.php/2016/05/27/kak-uznat-sid-polzovatelya-po-imeni-i-naoborot/)
4. [https://greendail.ru/node/uznat-imya-polzovatelya-po-sid-ili-sid-po-imeni-polzovatelya](https://greendail.ru/node/uznat-imya-polzovatelya-po-sid-ili-sid-po-imeni-polzovatelya)
5. [https://windowsnotes.ru/cmd/kak-uznat-sid-polzovatelya/](https://windowsnotes.ru/cmd/kak-uznat-sid-polzovatelya/)
6. [https://winitpro.ru/index.php/2015/05/21/powershell-get-aduser-poluchenie-dannih-o-polzovatelyax-active-directory/](https://winitpro.ru/index.php/2015/05/21/powershell-get-aduser-poluchenie-dannih-o-polzovatelyax-active-directory/)
7. [https://learn.microsoft.com/ru-ru/windows/win32/secauthz/well-known-sids](https://learn.microsoft.com/ru-ru/windows/win32/secauthz/well-known-sids)
8. [https://qna.habr.com/q/404700](https://qna.habr.com/q/404700)

---

Answer from Perplexity: [https://www.perplexity.ai/search/kak-na-windows-posmotret-sid-k-9PblcD0cQ1CuT4lrSvr.ww?utm_source=copy_output](https://www.perplexity.ai/search/kak-na-windows-posmotret-sid-k-9PblcD0cQ1CuT4lrSvr.ww?utm_source=copy_output)