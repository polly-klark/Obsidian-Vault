#network #htb 

Беспроводные сети — это компьютерные сети, в которых для передачи данных между узлами сети используются беспроводные соединения. Такие сети позволяют таким устройствам, как ноутбуки, смартфоны и планшеты, взаимодействовать друг с другом и с Интернетом без использования физических соединений, например кабелей.

Беспроводные сети используют радиочастотную (`RF`) технологию для передачи данных между устройствами. Каждое устройство в беспроводной сети оснащено беспроводным адаптером, который преобразует данные в радиочастотные сигналы и отправляет их по воздуху. Другие устройства в сети принимают эти сигналы с помощью собственных беспроводных адаптеров, после чего данные преобразуются обратно в пригодную для использования форму. В зависимости от используемой технологии они могут работать в разных диапазонах. Например, локальная вычислительная сеть (ЛВС), охватывающая небольшую территорию, такую как дом или небольшой офис, может использовать беспроводную технологию под названием `WiFi`, радиус действия которой составляет несколько сотен футов. С другой стороны, глобальная беспроводная сеть (`WWAN`) может использовать технологии мобильной связи, такие как передача данных по сотовой сети (`3G`, `4G LTE`, `5G`), которая может охватывать гораздо большую территорию, например весь город или регион.

Таким образом, чтобы подключиться к беспроводной сети, устройство должно находиться в зоне действия сети и иметь правильные сетевые настройки, такие как имя сети и пароль. После подключения устройства могут взаимодействовать друг с другом и с Интернетом, что позволяет пользователям получать доступ к онлайн-ресурсам и обмениваться данными.

Обмен данными между устройствами происходит по радиочастоте в диапазонах `2.4 GHz` или `5 GHz` в сети Wi-Fi. Когда устройство, например ноутбук, хочет отправить данные по сети, оно сначала связывается с [точкой беспроводного доступа](https://en.wikipedia.org/wiki/Wireless_access_point) (`WAP`), чтобы запросить разрешение на передачу. Точка беспроводного доступа — это центральное устройство, например маршрутизатор, которое соединяет беспроводную сеть с проводной и контролирует доступ к сети. После того как точка беспроводного доступа даёт разрешение, передающее устройство отправляет данные в виде радиочастотных сигналов, которые принимаются беспроводными адаптерами других устройств в сети. Затем данные преобразуются обратно в пригодную для использования форму и передаются соответствующему приложению или системе.

На мощность радиочастотного сигнала и расстояние, на которое он может распространяться, влияют такие факторы, как мощность передатчика, наличие препятствий и уровень радиочастотного шума в окружающей среде. Поэтому для обеспечения надёжной связи в сетях Wi-Fi используются такие методы, как передача с расширенным спектром и коррекция ошибок.

---

## Подключение к Wi-Fi

Устройство также должно быть настроено с использованием правильных сетевых параметров, таких как имя сети / [идентификатор набора служб](https://www.geeksforgeeks.org/service-set-identifier-ssid-in-computer-network/) (`SSID`) и `password`. Таким образом, для подключения к маршрутизатору ноутбук использует протокол беспроводной сети под названием [IEEE 802.11](https://en.wikipedia.org/wiki/IEEE_802.11). Этот протокол определяет технические аспекты взаимодействия беспроводных устройств друг с другом и с точками доступа. Когда устройство хочет подключиться к сети Wi-Fi, оно отправляет запрос на точку доступа, чтобы инициировать процесс подключения. Этот запрос известен как `connection request frame` или `association request` и отправляется с использованием `IEEE 802.11` протокола беспроводной сети. Фрейм запроса на подключение содержит различные информационные поля, в том числе следующие, но не ограничиваясь ими:

|                                |                                                                                                |
| ------------------------------ | ---------------------------------------------------------------------------------------------- |
| `MAC address`                  | Уникальный идентификатор беспроводного адаптера устройства.                                    |
| `SSID`                         | Имя сети, также известное как `Service Set Identifier` сети Wi-Fi.                             |
| `Supported data rates`         | Список скоростей передачи данных, поддерживаемых устройством.                                  |
| `Supported channels`           | Список `channels` (частот), на которых устройство может осуществлять связь.                    |
| `Supported security protocols` | Список протоколов безопасности, которые может использовать устройство, например `WPA2`/`WPA3`. |

Затем устройство использует эту информацию для настройки своего беспроводного адаптера и подключения к WAP. После установления соединения устройство может взаимодействовать с WAP и другими сетевыми устройствами. Оно также может получать доступ к Интернету и другим онлайн-ресурсам через WAP, который выступает в роли шлюза для подключения к проводной сети. Однако `SSID` можно скрыть, отключив широковещательную рассылку. Это означает, что устройства, которые ищут конкретный WAP, не смогут определить его `SSID`. Тем не менее `SSID` можно найти в пакете аутентификации.

Помимо протокола `IEEE 802.11` в сети Wi-Fi могут использоваться и другие сетевые протоколы и технологии, такие как TCP/IP, DHCP и WPA2, для выполнения таких задач, как назначение IP-адресов устройствам, маршрутизация трафика между устройствами и обеспечение безопасности.

#### Рукопожатие WEP «запрос-ответ»

Рукопожатие «запрос-ответ» — это процесс установления безопасного соединения между точкой доступа WAP и клиентским устройством в беспроводной сети, использующей протокол безопасности WEP. Для аутентификации устройства и установления безопасного соединения WAP и клиентское устройство обмениваются пакетами.

|**Шаг**|**Кто**|**Описание**|
|---|---|---|
|1|`Client`|Отправляет на WAP пакет запроса на подключение с просьбой предоставить доступ.|
|2|`WAP`|Отправляет клиенту пакет с ответом на запрос ассоциации, который содержит строку запроса.|
|3|`Client`|Рассчитывает ответ на строку запроса и общий секретный ключ и отправляет его обратно в WAP.|
|4|`WAP`|Рассчитывает ожидаемый ответ на запрос с использованием того же общего секретного ключа и отправляет клиенту пакет с ответом на аутентификацию.|

Тем не менее некоторые пакеты могут теряться, поэтому была внедрена так называемая `CRC` контрольная сумма. [Циклический избыточный код](https://en.wikipedia.org/wiki/Cyclic_redundancy_check) (`CRC`) — это механизм обнаружения ошибок, используемый в протоколе WEP для защиты от повреждения данных при беспроводной передаче. Для каждого пакета, передаваемого по беспроводной сети, на основе данных пакета вычисляется значение CRC. Оно используется для проверки целостности данных. Когда устройство назначения получает пакет, значение CRC пересчитывается и сравнивается с исходным значением. Если значения совпадают, значит, данные были успешно переданы без ошибок. Однако если значения не совпадают, значит, данные были повреждены и их необходимо передать повторно.

В конструкции `CRC` механизма есть изъян, который позволяет нам расшифровать один пакет `without encryption key`. Это связано с тем, что значение `CRC` вычисляется на основе `plaintext` данных в пакете, а не зашифрованных данных. В WEP значение CRC включается в заголовок пакета вместе с зашифрованными данными. Когда устройство назначения получает пакет, значение `CRC` пересчитывается и сравнивается с исходным значением, чтобы убедиться, что данные были успешно переданы без ошибок. Однако мы можем использовать `CRC` для определения незашифрованных данных в пакете, даже если данные зашифрованы.

---

## Функции безопасности

Сети Wi-Fi имеют ряд функций безопасности, которые защищают от несанкционированного доступа и обеспечивают конфиденциальность и целостность данных, передаваемых по сети. К основным функциям безопасности относятся:

- Шифрование
- Контроль доступа
- Брандмауэр

#### Шифрование

Для защиты конфиденциальности данных, передаваемых по беспроводным сетям, можно использовать различные алгоритмы шифрования. Наиболее распространёнными алгоритмами шифрования в сетях Wi-Fi являются [Wired Equivalent Privacy](https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy) (`WEP`), [WiFi Protected Access 2](https://en.wikipedia.org/wiki/Wi-Fi_Protected_Access#WPA2) (`WPA2`) и [WiFi Protected Access 3](https://en.wikipedia.org/wiki/Wi-Fi_Protected_Access#WPA3) (`WPA3`).

#### Контроль доступа

По умолчанию сети Wi-Fi настроены таким образом, чтобы авторизованные устройства могли подключаться к сети с помощью определённых методов аутентификации. Однако эти методы можно изменить, потребовав от авторизованных устройств ввода пароля или уникального идентификатора (например, MAC-адреса).

#### Брандмауэр

Брандмауэр — это система безопасности, которая контролирует входящий и исходящий сетевой трафик в соответствии с заданными правилами безопасности. Например, маршрутизаторы Wi-Fi часто имеют встроенные брандмауэры, которые могут блокировать входящий трафик из Интернета и защищать от различных типов киберугроз.

---

## Протоколы шифрования

[Wired Equivalent Privacy](https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy) (`WEP`) и [WiFi Protected Access](https://en.wikipedia.org/wiki/Wi-Fi_Protected_Access) (`WPA`) — это протоколы шифрования, которые защищают данные, передаваемые по сети WiFi. WPA может использовать различные алгоритмы шифрования, в том числе [Advanced Encryption Standard](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard) (`AES`).

#### WEP

`WEP` Для шифрования данных используется `40-bit` или `104-bit` ключ, а в `WPA using AES` используется `128-bit` ключ. Более длинные ключи обеспечивают более надёжное шифрование и более устойчивы к атакам. Однако этот протокол уязвим для различных атак, которые могут позволить злоумышленнику расшифровать данные, передаваемые по сети. Кроме того, WEP несовместим с новыми устройствами и операционными системами и в целом больше не считается безопасным. Наконец, `WEP` использует алгоритм шифрования `RC4 cipher`, что делает его уязвимым для атак.

Однако в WEP для аутентификации используется `shared key`, то есть для шифрования и аутентификации используется один и тот же ключ. Существует две версии протокола WEP:

- `WEP-40`/`WEP-64`
- `WEP-104`

`WEP-40`, также известный как `WEP-64`, использует `40-bit` (секретный) ключ, а `WEP-104` использует ключ `104-bit` . Ключ делится на [вектор инициализации](https://en.wikipedia.org/wiki/Initialization_vector) (`IV`) и `secret key`.

`IV` — это небольшое значение, которое включается в заголовок пакета вместе с зашифрованными данными и используется для создания ключей `WEP-40` и `WEP-104`. Оно включается для того, чтобы каждый ключ был уникальным. Секретный ключ — это последовательность случайных битов, которая используется для шифрования данных. Однако `WEP-104` имеет `80-bits` длину `secret key`. Давайте рассмотрим следующую таблицу, чтобы наглядно увидеть различия:

|**Протокол**|**IV**|**Секретный Ключ**|
|---|---|---|
|`WEP-40`/`WEP-64`|24-битный|40-битный|
|`WEP-104`|24-битный|80-битный|

Однако, поскольку IV в WEP относительно небольшой, мы можем перебрать все возможные комбинации символов и определить правильное значение. После этого мы можем использовать его для расшифровки данных в пакете. Это позволит нам получить доступ к данным, передаваемым по беспроводной сети, и потенциально поставить под угрозу безопасность сети.

#### WPA

`WPA` обеспечивает высочайший уровень безопасности и не подвержен тем же типам атак, что и WEP. Кроме того, WPA использует более безопасные методы аутентификации, такие как [предварительно установленный ключ](https://en.wikipedia.org/wiki/Pre-shared_key) (`PSK`) или сервер аутентификации 802.1X, которые обеспечивают более надежную защиту от несанкционированного доступа. Хотя старые устройства могут не поддерживать WPA, этот стандарт совместим с большинством устройств и операционных систем. Все беспроводные сети, особенно в критически важных инфраструктурах, таких как офисы, должны использовать шифрование как минимум `WPA2` или даже `WPA3` уровня.

---

## Протоколы аутентификации

[Лёгкий расширяемый протокол аутентификации](https://en.wikipedia.org/wiki/Lightweight_Extensible_Authentication_Protocol) (`LEAP`) и [Защищённый расширяемый протокол аутентификации](https://en.wikipedia.org/wiki/Protected_Extensible_Authentication_Protocol) (`PEAP`) — это протоколы аутентификации, которые используются для защиты беспроводных сетей и обеспечивают безопасный способ аутентификации устройств в беспроводной сети. Они часто используются в сочетании с WEP или WPA для обеспечения дополнительного уровня безопасности.

И LEAP, и PEAP основаны на [расширяемом протоколе аутентификации](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol) (`EAP`), системе аутентификации, используемой в различных сетевых контекстах. Однако ключевое различие между `LEAP` и `PEAP` заключается в том, как они обеспечивают безопасность процесса аутентификации.

- `LEAP` `shared key` используется для аутентификации, то есть `same key` используется для `encryption and authentication`.

Это может облегчить нам задачу по получению доступа к сети в случае компрометации ключа.

Однако `PEAP` использует более безопасный метод аутентификации под названием «туннелированный [Transport Layer Security](https://en.wikipedia.org/wiki/Transport_Layer_Security)» (`TLS`). Этот метод устанавливает безопасное соединение между устройством и точкой доступа WAP с помощью `digital certificate`, а зашифрованный туннель защищает процесс аутентификации. Это обеспечивает более надёжную защиту от несанкционированного доступа и делает систему более устойчивой к атакам.

---

## TACACS+

В беспроводной сети, когда точка беспроводного доступа (WAP) отправляет запрос на аутентификацию на сервер [Terminal Access Controller Access-Control System Plus](https://web.archive.org/web/20250423051356/https://www.ciscopress.com/articles/article.asp?p=422947&seqNum=4) (`TACACS+`), скорее всего, `entire request packet` будет зашифрован для защиты конфиденциальности и целостности запроса.

`TACACS+` Это протокол, используемый для аутентификации и авторизации пользователей при доступе к сетевым устройствам, таким как маршрутизаторы и коммутаторы. Когда WAP отправляет запрос на аутентификацию на `TACACS+`-сервер, запрос обычно содержит учётные данные пользователя и другую информацию о сеансе.

Шифрование запроса на аутентификацию помогает защитить конфиденциальную информацию от посторонних лиц, которые могут перехватить запрос. В то же время запрос передаётся по сети. Это также помогает предотвратить подмену запроса или замену его собственным вредоносным запросом.

Для шифрования запроса на аутентификацию можно использовать несколько методов шифрования, например `SSL`/`TLS` или `IPSec`. Конкретный используемый метод шифрования может зависеть от конфигурации сервера `TACACS+` и возможностей WAP.

---

## Атака Диссоциации

[Атака с разрывом соединения](https://www.makeuseof.com/what-are-disassociation-attacks/) — это тип `all` атаки на беспроводную сеть, целью которой является нарушение связи между точкой доступа WAP и её клиентами путём отправки кадров разрыва соединения одному или нескольким клиентам.

WAP использует кадры отключения для отсоединения клиента от сети. Когда WAP отправляет клиенту кадр отключения, клиент отключается от сети и должен повторно подключиться, чтобы продолжить пользоваться сетью.

Мы можем запустить атаку из `within` или `outside` сети в зависимости от нашего местоположения и мер сетевой безопасности. Цель этой атаки - нарушить связь между WAP и его клиентами, в результате чего клиенты отключаются и, возможно, причиняют неудобства или перебои пользователям. Мы также можем использовать это как предвестник других атак, таких как MITM-атака, заставляя клиентов повторно подключаться к сети и потенциально подвергая их дальнейшим атакам.

---

## Беспроводное Упрочнение

Существует множество различных способов защиты беспроводных сетей. Однако для значительного повышения уровня безопасности беспроводных сетей следует рассмотреть некоторые примеры. Вот некоторые из них, но не все:

- Отключение широковещательной передачи
- Защищенный Доступ к Wi-Fi
- Фильтрация по MAC
- Развертывание EAP-TLS

#### Отключение широковещательной передачи

Отключение широковещательной рассылки SSID — это мера безопасности, которая может повысить надёжность WAP, затруднив обнаружение сети и подключение к ней. При широковещательной рассылке SSID он включается в кадры маяка, которые регулярно передаются WAP для оповещения о доступности сети. Если отключить широковещательную рассылку SSID, WAP не будет передавать кадры маяка, и сеть не будет видна устройствам, которые ещё не подключены к ней.

#### WPA

WPA обеспечивает надёжное шифрование и аутентификацию для беспроводной связи, что помогает защититься от несанкционированного доступа к сети и перехвата конфиденциальных данных. WPA включает в себя две основные версии:

1. WPA-Personal
2. WPA-Enterprise

WPA-Personal предназначен для домашних сетей и сетей малого бизнеса, а WPA-Enterprise — для крупных организаций. Он использует централизованный сервер аутентификации (например, RADIUS или TACACS+) для проверки подлинности клиентов.

#### Фильтрация по MAC

Фильтрация по MAC-адресам — это мера безопасности, которая позволяет точке доступа принимать или отклонять подключения от определённых устройств на основе их MAC-адресов. Настроив точку доступа так, чтобы она принимала подключения только от устройств с разрешёнными MAC-адресами, можно предотвратить подключение к сети неавторизованных устройств.

#### Развертывание EAP-TLS

EAP-TLS — это протокол безопасности, используемый для аутентификации и шифрования данных при беспроводной передаче. Он использует цифровые сертификаты и инфраструктуру открытых ключей для проверки подлинности клиентов и установления безопасных соединений. Внедрение EAP-TLS может повысить безопасность точки доступа Wi-Fi за счёт надёжной аутентификации и шифрования данных при беспроводной передаче, что может защитить от несанкционированного доступа к сети и перехвата конфиденциальных данных.