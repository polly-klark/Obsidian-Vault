#htb 

Песочница и изоляция — это методы обеспечения безопасности, которые используются для ограничения и контроля среды выполнения таких приложений, как браузеры, предотвращая несанкционированный доступ к системным ресурсам, данным или другим процессам. Например, если мы получаем подозрительную ссылку, мы можем запустить браузер в песочнице, которая не имеет доступа к файлам в нашей системе, и открыть ссылку в этом изолированном браузере.

Изоляция — это концепция безопасности, которая предполагает разделение процессов, приложений или целых сред для предотвращения их взаимодействия друг с другом или доступа к несанкционированным ресурсам.

Песочница — это часть изоляции и механизм безопасности, который запускает процессы и приложения в ограниченной среде.

---

## Огненная Тюрьма

Firejail — это инструмент для создания «песочницы», который ограничивает среду работы ненадежных приложений и процессов. Он легкий и использует функции безопасности ядра для изоляции процессов. Он поставляется с множеством предварительно настроенных профилей для тысяч приложений и очень прост в использовании.

Чтобы установить его, нам нужно добавить новый репозиторий и загрузить его с помощью менеджера пакетов APT. После установки мы можем запустить его с помощью `firejail`.

  Изоляция и Песочница

```shell-session
cry0l1t3@ubuntu:~$ sudo add-apt-repository ppa:deki/firejail
cry0l1t3@ubuntu:~$ sudo apt-get update
cry0l1t3@ubuntu:~$ sudo apt-get install firejail firejail-profiles

firejail
```

Далее мы можем установить `firetools` — простой графический интерфейс для управления песочницами. Давайте установим его:

  Изоляция и Песочница

```shell-session
cry0l1t3@ubuntu:~$ sudo apt install firetools -y
cry0l1t3@ubuntu:~$ firetools
```

Вы увидите новую боковую панель с несколькими приложениями и соответствующими профилями. При нажатии на одно из приложений оно запустится в «песочнице» с предварительно настроенным профилем.

В левом верхнем углу вы увидите значок для запуска панели конфигурации Firejail.

![Рабочий стол с запущенным в терминале приложением Firejail и окном конфигурации Firetools для выбора приложений в изолированной среде.](https://academy.hackthebox.com/storage/modules/87/iso1.png)

На этом этапе мы можем выбрать приложение, которое хотим изолировать, и запустить его.

![Окно конфигурации Firejail с меню выбора приложений и просмотром файловой системы, показывающее RustDesk в /usr/bin.](https://academy.hackthebox.com/storage/modules/87/iso2.png)

Это создаст новую «песочницу» и запустит приложение внутри этой «песочницы».

![На рабочем столе отображается вывод терминала Firejail, интерфейс RustDesk с идентификатором 161 824 388, паролем 8gd7ky и предупреждением о поддержке Wayland.](https://academy.hackthebox.com/storage/modules/87/iso3.png)

Однако, как и любое другое приложение, Firejail не является на 100% защищённым. В Firejail есть уязвимости, связанные с `namespaces` и `seccomp`, особенно если системные вызовы не фильтруются должным образом, и существует эксплойт для ядра, который может обойти ограничения Firejail.

---

## KASM

[Kasm Workspaces](https://kasmweb.com/), с другой стороны, — это контейнерная платформа для виртуализации рабочего стола и потоковой передачи приложений, которая предоставляет защищённые изолированные рабочие пространства через браузер. Она основана на принципах нулевого доверия и удалённой изоляции браузера (RBI). В отличие от Firejail, который работает локально на Linux, Kasm — это серверное решение, использующее контейнеры Docker для изоляции приложений и рабочих столов, которые также могут размещаться на собственном сервере.

![Домашняя страница Kasm Workspaces с текстом «Платформа потоковой передачи рабочих пространств» и опциями для Linux Desktop, Windows Desktop и облачного браузера.](https://academy.hackthebox.com/storage/modules/87/iso4.png)

Чтобы установить его, нам нужно скачать архив `.tar.gz` и выполнить скрипт с помощью следующих команд:

  Изоляция и Песочница

```shell-session
cry0l1t3@ubuntu:~$ cd /tmp
cry0l1t3@ubuntu:~$ curl -O https://kasm-static-content.s3.amazonaws.com/kasm_release_1.17.0.bbc15c.tar.gz
cry0l1t3@ubuntu:~$ tar -xf kasm_release_1.17.0.bbc15c.tar.gz
cry0l1t3@ubuntu:~$ sudo bash kasm_release/install.sh
```

После завершения установки вы увидите набор различных учётных данных для разных пользователей, баз данных и токенов.

![Терминал, показывающий установку Kasm с логином, базой данных, учётными данными Redis, токеном менеджера и токеном регистрации службы.](https://academy.hackthebox.com/storage/modules/87/iso5.png)

Когда мы перейдём на страницу https://localhost, чтобы войти в KASM, мы будем использовать учётные данные администратора, сгенерированные установочным скриптом.

![Страница входа в Kasm Workspaces с полями для ввода электронной почты и пароля, а также логотипом с надписью «Платформа потоковой передачи контейнеров».](https://academy.hackthebox.com/storage/modules/87/iso6.png)

На главной панели управления мы увидим всю статистику по пользователям, успешным входам в систему, неудачным входам, рабочим пространствам и многому другому.

![Интерфейс панели управления, отображающий статистику использования, текущую статистику и использование изображений с меню навигации слева.](https://academy.hackthebox.com/storage/modules/87/iso7.png)

Когда мы перейдём в раздел `Workspaces (sidebar) > Registry`, мы увидим набор предварительно настроенных образов, доступных для скачивания. Эти образы используются для запуска изолированной среды внутри контейнера Docker при каждом его запуске.

Рабочие пространства KASM также предоставляют образ Parrot OS.

![Интерфейс реестра рабочих пространств, отображающий доступные рабочие пространства с отфильтрованной Parrot OS, с меню навигации слева.](https://academy.hackthebox.com/storage/modules/87/iso8.png)

Для наглядности мы загрузим изображение браузера Brave.

![Интерфейс реестра рабочих пространств, отображающий установленные рабочие пространства с браузером Brave, с меню навигации слева.](https://academy.hackthebox.com/storage/modules/87/iso9.png)

После установки мы можем переключиться на `Workspaces (at the top)` и увидеть доступное изображение браузера Brave, которое мы только что загрузили. При нажатии на него будет создан новый изолированный контейнер.

![Горный пейзаж со значком браузера Brave, варианты навигации для рабочих пространств и администратора в верхней части экрана.](https://academy.hackthebox.com/storage/modules/87/iso10.png)

После загрузки контейнера мы можем использовать его в качестве браузера по умолчанию.

![Главная страница HTB Academy с текстом «Ваш путь в сфере кибербезопасности начинается здесь» и возможностью начать обучение бесплатно или для бизнеса.](https://academy.hackthebox.com/storage/modules/87/iso11.png)

Эти одноразовые рабочие пространства представляют собой эфемерные среды, которые уничтожаются после каждого сеанса, что обеспечивает отсутствие постоянных данных или отслеживания. Подробнее о бесшовной интеграции KASM можно узнать [здесь](https://kasmweb.com/docs/latest/guide/browser_isolation.html).