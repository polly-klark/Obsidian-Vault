#web #htb 

Наиболее критичными уязвимостями серверной части являются те, которые могут быть атакованы извне и использованы для получения контроля над серверной частью без необходимости локального доступа к этому серверу (т. е. при внешнем тестировании на проникновение). Эти уязвимости обычно возникают из-за ошибок в коде, допущенных при разработке серверных компонентов веб-приложения. Таким образом, в этой области существует множество типов уязвимостей: от базовых, которые можно относительно легко использовать, до сложных, требующих глубокого знания всего веб-приложения.

---

## Публичный CVE

Поскольку многие организации используют общедоступные веб-приложения, такие как веб-приложения с открытым исходным кодом и проприетарные веб-приложения, эти веб-приложения, как правило, тестируются многими организациями и экспертами по всему миру. Это приводит к частому обнаружению большого количества уязвимостей, большинство из которых устраняются, а затем публикуются в открытом доступе и получают запись и оценку CVE ([Common Vulnerabilities and Exposures](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures)).

Многие специалисты по тестированию на проникновение также создают эксплойты для проверки концепции, чтобы выяснить, можно ли использовать определённую общедоступную уязвимость, и обычно делают эти эксплойты доступными для общего пользования, тестирования и образовательных целей. Таким образом, поиск общедоступных эксплойтов — это первый шаг, который мы должны сделать при работе с веб-приложениями.

Совет: первым делом нужно определить версию веб-приложения. Ее можно найти во многих местах, например в исходном коде веб-приложения. Для веб-приложений с открытым исходным кодом можно проверить репозиторий веб-приложения и определить, где указан номер версии (например, на странице (version.php)), а затем проверить ту же страницу в целевом веб-приложении для подтверждения.

Определив версию веб-приложения, мы можем выполнить поиск общедоступных эксплойтов для этой версии веб-приложения в Google. Мы также можем использовать онлайн-базы данных эксплойтов, такие как [Exploit DB](https://www.exploit-db.com/), [Rapid7 DB](https://www.rapid7.com/db/) или [Vulnerability Lab](https://www.vulnerability-lab.com/). В следующем примере показан поиск общедоступных эксплойтов для WordPress в [Rapid7 DB](https://www.rapid7.com/db/):
   
![[Pasted image 20251230154347.png]]

Обычно нас интересуют эксплойты с оценкой CVE 8–10 или эксплойты, которые приводят к `Remote Code Execution`. Если ничего из вышеперечисленного нет в наличии, следует рассмотреть другие типы общедоступных эксплойтов.

Кроме того, эти уязвимости характерны не только для веб-приложений, но и для компонентов, используемых веб-приложением. Если веб-приложение использует внешние компоненты (например, плагины), нам также следует искать уязвимости в этих внешних компонентах.

---

## Общая система оценки уязвимостей (CVSS)

[Общая система оценки уязвимостей (CVSS)](https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System) — это отраслевой стандарт с открытым исходным кодом для оценки серьезности уязвимостей в системе безопасности. Эта система оценки часто используется в качестве стандартного метода измерения для организаций и государственных учреждений, которым необходимо получать точные и согласованные оценки серьезности уязвимостей в своих системах. Это помогает расставлять приоритеты в распределении ресурсов и реагировать на конкретную угрозу.

Баллы CVSS рассчитываются по формуле, в которой используется несколько показателей: `Base`, `Temporal` и `Environmental`. При расчете серьезности уязвимости с помощью CVSS `Base` показатели дают оценку от 0 до 10, которая корректируется с помощью `Temporal` и `Environmental` показателей. [Национальная база данных уязвимостей (NVD)](https://nvd.nist.gov/) предоставляет баллы CVSS почти для всех известных уязвимостей, информация о которых была опубликована. В настоящее время NVD предоставляет только `Base` баллы, основанные на характеристиках конкретной уязвимости. В настоящее время используются системы оценки CVSS v2 и CVSS v3. Между системами v2 и v3 есть несколько различий, в частности, в группах `Base` и `Environmental` добавлены дополнительные показатели. Более подробную информацию о различиях между двумя системами оценки можно найти [здесь](https://www.balbix.com/insights/cvss-v2-vs-cvss-v3).

Оценки по шкале CVSS для V2 и V3 немного отличаются, как видно из следующих таблиц:

|Рейтинг CVSS V2.0| |
|---|---|
|**Серьезность**|**Базовый Диапазон Оценок**|
|Низкий|0.0-3.9|
|Средний|4.0-6.9|
|Высокий|7.0-10.0|

|**Рейтинг CVSS V3.0**| |
|---|---|
|**Серьезность**|**Базовый Диапазон Оценок**|
|Нет|0.0|
|Низкий|0.1-3.9|
|Средний|4.0-6.9|
|Высокий|7.0-8.9|
|Критический|9.0-10.0|

NVD не учитывает показатели `Temporal` и `Environmental`, поскольку первые могут меняться со временем в зависимости от внешних событий. Второй показатель — это индивидуальная метрика, основанная на потенциальном влиянии уязвимости на конкретную организацию. NVD предоставляет [калькулятор CVSS v2](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator) и [калькулятор CVSS v3](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator), с помощью которых организации могут учитывать дополнительные риски, связанные с `Temporal` и `Environmental` уникальными для них данными. Калькуляторы очень интерактивны, и с их помощью можно точно настроить оценку CVSS для нашей среды. Мы можем перейти к каждому показателю, чтобы узнать о нём больше и понять, как именно он применим к нашей организации. Ниже приведён пример использования калькулятора CVSS v3:

![[Pasted image 20251230154410.png]]

Поэкспериментируйте с калькулятором CVSS и посмотрите, как можно настроить различные показатели, чтобы получить заданный балл. Изучите несколько уязвимостей CVE и попытайтесь получить такой же балл по CVSS. Как меняется балл по CVSS при использовании показателей `Temporal` и `Environmental`? Это удобное [руководство](https://www.first.org/cvss/user-guide) очень полезно для понимания V2 и V3, а также для использования калькуляторов для получения заданного балла.

---

## Уязвимости внутреннего сервера

Как и в случае с общедоступными уязвимостями веб-приложений, нам следует обратить внимание на уязвимости других внутренних компонентов, таких как внутренний сервер или веб-сервер.

Наиболее критичные уязвимости серверных компонентов обнаруживаются в веб-серверах, поскольку они находятся в открытом доступе по протоколу `TCP` . Примером известной уязвимости веб-сервера является `Shell-Shock`, которая затрагивала веб-серверы Apache, выпущенные до 2014 года, и использовала `HTTP`-запросы для получения удалённого контроля над серверной частью.

Что касается уязвимостей на внутреннем сервере или в базе данных, то они обычно используются после получения локального доступа к внутреннему серверу или внутренней сети, который может быть получен с помощью `external` уязвимостей или в ходе внутреннего тестирования на проникновение. Обычно они используются для получения привилегированного доступа к внутреннему серверу или внутренней сети или для получения контроля над другими серверами в той же сети.

Хотя эти уязвимости нельзя использовать напрямую извне, они всё равно являются критическими и требуют устранения, чтобы защитить всё веб-приложение от взлома.