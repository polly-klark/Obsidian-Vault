#htb 

Удаленное подключение к рабочему столу позволяет пользователям получать доступ к компьютеру, серверу или среде рабочего стола и управлять ими удаленно по сети. Это используется в тех случаях, когда физический доступ нецелесообразен или неудобен. Например, если сотруднику нужна помощь с определенными настройками на его компьютере с Windows, мы можем оказать ее, не заходя в офис. Все, что нам нужно сделать, — это удаленно подключиться к его компьютеру по протоколу удаленного рабочего стола.

Для этого нам нужен клиент RDP, который справится с этой задачей. Существует множество различных инструментов для этого, но мы рассмотрим только три из них:

|`XfreeRDP`|`RDesktop`|`Rustdesk`|
|---|---|---|

---

## XFREERDP

Xfreerdp — это клиент командной строки, который позволяет подключаться к RDP-серверам, поддерживающим аутентификацию на сетевом уровне, шифрование TLS и передачу учётных данных. Он оптимизирован для подключения с низкой задержкой и поддерживает сжатие H.264, что гарантирует, что даже если соединение не самое лучшее, мы, скорее всего, сможем выполнить необходимую работу.

Pwnbox имеет `xfreerdp` предустановленную версию, которую можно использовать из терминала. Если вы хотите установить его на другой дистрибутив на базе Debian, вы можете использовать следующую команду:

  Удаленный рабочий стол

```shell-session
cry0l1t3@ubuntu:~$ sudo apt install xfreerdp -y
```

После установки мы можем указать имя пользователя (`/u:`), пароль (`/p:`) и удалённый хост RDP (`/v:`), к которому мы хотим подключиться. Это инициализирует подключение RDP, и вам будет предложено довериться этому устройству. После подтверждения появится новое окно с рабочим столом удалённого хоста.

![На разделённом экране слева отображается рабочий стол Windows через FreeRDP, а справа — терминал с выводом команды xfreerdp, включая сведения о проверке сертификата и ошибку входа в систему.](https://academy.hackthebox.com/storage/modules/87/rdp1.png)

---

## RDESKTOP

Rdesktop — это более старый клиент RDP с открытым исходным кодом, который является легковесным, но менее активно поддерживаемым, чем FreeRDP. Это приводит к ограниченной поддержке современных функций RDP, таких как аутентификация на сетевом уровне и современное шифрование TLS. Его можно установить с помощью следующей команды:

  Удаленный рабочий стол

```shell-session
cry0l1t3@ubuntu:~$ sudo apt install rdesktop -y
```

Для установления RDP-соединения, как и в случае с `xfreerdp` , мы можем указать имя пользователя (`-u`), пароль (`-p`) и целевой домен (`-d`) при необходимости. IP-адрес удалённого хоста не требует указания флага, но будет добавлен в конце команды.

![Разделенный экран с рабочим столом Windows через rdesktop слева и выводом терминала справа, где отображаются предупреждения о сертификатах и сведения о подключении.](https://academy.hackthebox.com/storage/modules/87/rdp2.png)

---

## Rustdesk

[Rustdesk](https://rustdesk.com/) — это альтернатива TeamViewer и AnyDesk с открытым исходным кодом, но она служит другой цели. По умолчанию вы не можете сразу подключиться к RDP-серверу, так как для этого требуется идентификатор сеанса и пароль, которые генерируются на каждом хосте. Это требует взаимодействия с пользователем как со стороны администратора, так и со стороны пользователя. С одной стороны, администратор не может управлять хостом, если пользователь не предоставит ему к нему доступ. Но с другой стороны, если RDP будет деактивирован, злоумышленнику будет гораздо сложнее получить удалённый доступ к хосту Windows или Linux.

Мы можем зайти на их домашнюю страницу и скачать необходимый пакет. Вы можете использовать только клиентскую часть или самостоятельно разместить сервис.

![Домашняя страница RustDesk, продвигающая программное обеспечение для удалённого доступа с открытым исходным кодом, с возможностью скачивания и самостоятельного размещения.](https://academy.hackthebox.com/storage/modules/87/rdp3.png)

После загрузки клиента мы можем установить его с помощью следующей команды:

  Удаленный рабочий стол

```shell-session
cry0l1t3@ubuntu:~$ cd ~/Downloads
cry0l1t3@ubuntu:~$ sudo apt install ./rustdesk-1.3.9-x86_64.deb -y
```

После установки мы можем запустить программу и увидеть следующее окно с идентификатором сеанса и одноразовым паролем.

![Интерфейс удалённого рабочего стола с идентификатором 161 824 388, паролем wq3jzr и предупреждением о поддержке Wayland. Недавние сеансы недоступны.](https://academy.hackthebox.com/storage/modules/87/rdp4.png)

В этом примере мы также загрузили тот же клиент на компьютер с Windows и запустили его. Теперь мы возьмём идентификатор сеанса и одноразовый пароль с хоста Windows и используем их на нашем хосте Linux для подключения.

![Интерфейс удалённого рабочего стола с идентификатором 153 069 124, паролем 575twm и предупреждением UAC об установке RustDesk. Недавние сеансы недоступны.](https://academy.hackthebox.com/storage/modules/87/rdp5.png)

После ввода идентификатора сеанса нам будет предложено ввести одноразовый пароль хоста Windows.

![Запрос пароля для подтверждения RustDesk с возможностью ввести пароль, запомнить пароль, а также с кнопками отмены и подтверждения.](https://academy.hackthebox.com/storage/modules/87/rdp6.png)

Если учётные данные указаны правильно, мы увидим новое окно с информацией об удалении подключения к рабочему столу.

![Интерфейс удалённого рабочего стола с идентификатором 161 824 388, паролем wq3jzr, предупреждением о поддержке Wayland и подключением к идентификатору 153 069 124.](https://academy.hackthebox.com/storage/modules/87/rdp7.png)

Это особенно полезно, когда нам нужно помочь кому-то удалённо. Rustdesk — одно из лучших решений для таких задач, поскольку все подключения по умолчанию используют сквозное шифрование (E2EE) на основе NaCl, что обеспечивает конфиденциальность и безопасность данных во время всех удалённых сеансов. Кроме того, он поддерживает передачу файлов, обмен буфером обмена, работу с несколькими мониторами, запись сеансов, онлайн-чат и туннелирование TCP. Этот набор функций делает этот инструмент безопасным и эффективным, что идеально подходит для наших целей.
