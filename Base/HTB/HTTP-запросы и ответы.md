#htb #web #http 

HTTP-коммуникация в основном состоит из HTTP-запроса и HTTP-ответа. HTTP-запрос отправляется клиентом (например, cURL/браузером) и обрабатывается сервером (например, веб-сервером). Запросы содержат всю необходимую информацию о сервере, включая ресурс (например, URL, путь, параметры), любые данные запроса, указанные нами заголовки или параметры, а также множество других параметров, которые мы рассмотрим в этом модуле.

Как только сервер получает HTTP-запрос, он обрабатывает его и отправляет HTTP-ответ, который содержит код ответа, как описано в следующем разделе, и может содержать данные ресурса, если у отправителя запроса есть к ним доступ.

---

## HTTP-запрос

Давайте рассмотрим следующий пример HTTP-запроса:

![[Pasted image 20260114205848.png]]

На изображении выше показан HTTP-запрос GET к URL-адресу:

- `http://inlanefreight.com/users/login.html`

Первая строка любого HTTP-запроса содержит три основных поля, разделённых пробелами:

|**Поле**|**Пример**|**Описание**|
|---|---|---|
|`Method`|`GET`|HTTP-метод или глагол, указывающий на тип выполняемого действия.|
|`Path`|`/users/login.html`|Путь к ресурсу, к которому осуществляется доступ. К этому полю также можно добавить строку запроса (например, `?username=user`).|
|`Version`|`HTTP/1.1`|Третье и последнее поле используется для обозначения версии HTTP.|

Следующий набор строк содержит пары значений HTTP-заголовков, например `Host`, `User-Agent`, `Cookie` и многие другие возможные заголовки. Эти заголовки используются для указания различных атрибутов запроса. Заголовки завершаются переводом строки, который необходим серверу для проверки запроса. Наконец, запрос может заканчиваться телом запроса и данными.

**Примечание:** HTTP версии 1.X отправляет запросы в виде обычного текста и использует символ новой строки для разделения различных полей и запросов. HTTP версии 2.X, напротив, отправляет запросы в виде двоичных данных в форме словаря.

---

## HTTP-ответ

После того как сервер обработает наш запрос, он отправит ответ. Ниже приведён пример HTTP-ответа:

![[Pasted image 20260114205908.png]]

Первая строка HTTP-ответа содержит два поля, разделённых пробелами. Первое — это `HTTP version` (например, `HTTP/1.1`), а второе обозначает `HTTP response code` (например, `200 OK`).

Коды ответа используются для определения статуса запроса, как будет показано в следующем разделе. После первой строки в ответе перечисляются заголовки, как и в HTTP-запросе. Заголовки запроса и ответа рассматриваются в следующем разделе.

Наконец, ответ может содержать тело ответа, которое отделяется от заголовков новой строкой. Тело ответа обычно определяется как `HTML` код. Однако ответ может содержать и другие типы кода, например `JSON`, веб-ресурсы, такие как изображения, таблицы стилей или скрипты, или даже документ, например PDF-файл, размещённый на веб-сервере.

---

## cURL

В предыдущих примерах с cURL мы указывали только URL-адрес и получали в ответ тело запроса. Однако cURL также позволяет просматривать полный HTTP-запрос и полный HTTP-ответ, что может быть очень удобно при проведении тестов на проникновение в веб-приложения или при написании эксплойтов. Чтобы просмотреть полный HTTP-запрос и ответ, мы можем просто добавить `-v` флаг verbose к нашим предыдущим командам, и он выведет запрос и ответ:

  HTTP-запросы и ответы

```shell-session
Barlogsha@htb[/htb]$ curl inlanefreight.com -v

*   Trying SERVER_IP:80...
* TCP_NODELAY set
* Connected to inlanefreight.com (SERVER_IP) port 80 (#0)
> GET / HTTP/1.1
> Host: inlanefreight.com
> User-Agent: curl/7.65.3
> Accept: */*
> Connection: close
> 
* Mark bundle as not supporting multiuse
< HTTP/1.1 401 Unauthorized
< Date: Tue, 21 Jul 2020 05:20:15 GMT
< Server: Apache/X.Y.ZZ (Ubuntu)
< WWW-Authenticate: Basic realm="Restricted Content"
< Content-Length: 464
< Content-Type: text/html; charset=iso-8859-1
< 
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>

...SNIP...
```

Как мы видим, на этот раз мы получаем полный HTTP-запрос и ответ. Запрос просто отправлял `GET / HTTP/1.1` вместе с заголовками `Host`, `User-Agent` и `Accept`. В ответ HTTP-запрос содержал `HTTP/1.1 401 Unauthorized`, что указывает на отсутствие у нас доступа к запрошенному ресурсу, как мы увидим в следующем разделе. Как и в случае с запросом, ответ также содержал несколько заголовков, отправленных сервером, в том числе `Date`, `Content-Length`, и `Content-Type`. Наконец, ответ содержал тело ответа в формате HTML, которое мы получали ранее при использовании cURL без флага `-v`.

**Упражнение:** Флаг `-vvv` выводит ещё более подробный результат. Попробуйте использовать этот флаг, чтобы увидеть, какие дополнительные сведения о запросе и ответе он выводит.

---

## Браузерные инструменты разработчика

Большинство современных веб-браузеров имеют встроенные инструменты разработчика (`DevTools`), которые в основном предназначены для тестирования веб-приложений разработчиками. Однако для специалистов по тестированию веб-приложений на проникновение эти инструменты могут стать важным подспорьем при любой веб-оценке, поскольку браузер (и его инструменты разработчика) — это то, что, скорее всего, будет у нас под рукой при любой веб-оценке. В этом модуле мы также обсудим, как использовать базовые инструменты разработчика для оценки и мониторинга различных типов веб-запросов.

Всякий раз, когда мы заходим на какой-либо веб-сайт или в какое-либо веб-приложение, наш браузер отправляет множество веб-запросов и обрабатывает множество HTTP-ответов, чтобы отобразить то, что мы видим в окне браузера. Чтобы открыть инструменты разработчика в Chrome или Firefox, можно нажать [`CTRL+SHIFT+I`] или просто нажать [`F12`]. Инструменты разработчика содержат несколько вкладок, каждая из которых предназначена для определённых целей. В этом модуле мы в основном будем рассматривать вкладку `Network`, поскольку она отвечает за веб-запросы.

Если мы перейдём на вкладку «Сеть» и обновим страницу, то сможем увидеть список запросов, отправленных страницей: ![[Pasted image 20260114205921.png]]

Как мы видим, инструменты разработчика сразу показывают статус ответа (т. е. код ответа), используемый метод запроса (`GET`), запрошенный ресурс (т. е. URL/домен), а также запрошенный путь. Кроме того, мы можем использовать `Filter URLs` для поиска конкретного запроса, если на сайте их слишком много.

**Упражнение:** Попробуйте нажать на любой из запросов, чтобы просмотреть его детали. Затем вы можете нажать на вкладку `Response`, чтобы просмотреть тело ответа, а затем нажать на кнопку `Raw`, чтобы просмотреть исходный (неотрендеренный) код тела ответа.