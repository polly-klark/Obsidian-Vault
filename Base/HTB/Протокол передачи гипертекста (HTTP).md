#web #htb #http 

Сегодня большинство приложений, которыми мы пользуемся, постоянно взаимодействуют с интернетом, как веб-приложения, так и мобильные приложения. Большинство интернет-коммуникаций осуществляется с помощью веб-запросов по протоколу HTTP. [HTTP](https://tools.ietf.org/html/rfc2616) — это протокол прикладного уровня, используемый для доступа к ресурсам Всемирной паутины. Термин `hypertext` означает текст, содержащий ссылки на другие ресурсы и текст, который читатели могут легко интерпретировать.

HTTP-соединение состоит из клиента и сервера, при этом клиент запрашивает у сервера ресурс. Сервер обрабатывает запросы и возвращает запрошенный ресурс. По умолчанию для HTTP-соединения используется порт `80`, но его можно изменить на любой другой в зависимости от конфигурации веб-сервера. Те же запросы используются, когда мы выходим в интернет и посещаем разные веб-сайты. Мы вводим `Fully Qualified Domain Name` (`FQDN`) в качестве `Uniform Resource Locator` (`URL`), чтобы попасть на нужный веб-сайт, например [www.hackthebox.com](http://www.hackthebox.com/).

---

## URL

Доступ к ресурсам по протоколу HTTP осуществляется через `URL`, который предлагает гораздо больше возможностей, чем простое указание веб-сайта, который мы хотим посетить. Давайте рассмотрим структуру URL: ![[Pasted image 20260112210854.png]]

Вот что означает каждый компонент:

| **Компонент**  | **Пример**           | **Описание**                                                                                                                                                                                  |
| -------------- | -------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Scheme`       | `http://` `https://` | Он используется для идентификации протокола, к которому обращается клиент, и заканчивается двоеточием и двойной косой чертой (`://`)                                                          |
| `User Info`    | `admin:password@`    | Это необязательный компонент, который содержит учётные данные (разделённые двоеточием `:`), используемые для аутентификации на хосте, и отделяется от хоста знаком `@`                        |
| `Host`         | `inlanefreight.com`  | Хост указывает на местоположение ресурса. Это может быть имя хоста или IP-адрес                                                                                                               |
| `Port`         | `:80`                | `Port` отделено от `Host` двоеточием (`:`). Если порт не указан, по умолчанию для `http` используется порт `80`, а для `https` — порт `443`                                                   |
| `Path`         | `/dashboard.php`     | Это указывает на ресурс, к которому осуществляется доступ, будь то файл или папка. Если путь не указан, сервер возвращает индекс по умолчанию (например, `index.html`).                       |
| `Query String` | `?login=true`        | Строка запроса начинается с вопросительного знака (`?`), состоит из параметра (например, `login`) и значения (например, `true`). Несколько параметров могут быть разделены амперсандом (`&`). |
| `Fragments`    | `#status`            | Фрагменты обрабатываются браузерами на стороне клиента для определения разделов основного ресурса (например, заголовка или раздела на странице).                                              |

Для доступа к ресурсу требуются не все компоненты. Основными обязательными полями являются схема и хост, без которых запрос не будет иметь ресурса для запроса.

---

## HTTP -поток

![[Pasted image 20260112210904.png]]

На схеме выше представлена структура HTTP-запроса на самом высоком уровне. Когда пользователь впервые вводит URL-адрес (`inlanefreight.com`) в браузере, он отправляет запрос на DNS-сервер (сервер системы доменных имён), чтобы тот разрешил домен и получил его IP-адрес. DNS-сервер ищет IP-адрес для `inlanefreight.com` и возвращает его. Все доменные имена должны быть разрешены таким образом, поскольку сервер не может взаимодействовать без IP-адреса.

**Примечание:** наши браузеры обычно сначала ищут записи в локальном файле '`/etc/hosts`', и если запрошенный домен в нём не найден, они обращаются к другим DNS-серверам. Мы можем использовать '`/etc/hosts`' для ручного добавления записей в DNS-сервер, указав IP-адрес и доменное имя.

Как только браузер получает IP-адрес, связанный с запрашиваемым доменом, он отправляет GET-запрос на HTTP-порт по умолчанию (например, `80`), запрашивая корневой путь `/` . Затем веб-сервер получает запрос и обрабатывает его. По умолчанию серверы настроены на возврат индексного файла при получении запроса на `/` .

В этом случае содержимое `index.html` считывается и возвращается веб-сервером в виде HTTP-ответа. Ответ также содержит код состояния (например, `200 OK`), который указывает на то, что запрос был успешно обработан. Затем веб-браузер отображает содержимое `index.html` и показывает его пользователю.

**Примечание:** этот модуль в основном посвящен веб-запросам HTTP. Дополнительную информацию о HTML и веб-приложениях можно найти в модуле [«Введение в веб-приложения»](https://academy.hackthebox.com/module/details/75).

---

## cURL

В этом модуле мы будем отправлять веб-запросы с помощью двух наиболее важных инструментов для любого специалиста по тестированию веб-приложений на проникновение: веб-браузера, такого как Chrome или Firefox, и инструмента командной строки `cURL` .

[cURL](https://curl.haxx.se/) (клиентский URL) — это инструмент командной строки и библиотека, которая в основном поддерживает HTTP, а также многие другие протоколы. Это делает его подходящим кандидатом для написания скриптов и автоматизации, а также незаменимым инструментом для отправки различных типов веб-запросов из командной строки, что необходимо для многих видов тестирования веб-приложений на проникновение.

Мы можем отправить базовый HTTP-запрос на любой URL-адрес, указав его в качестве аргумента для cURL следующим образом:

  Протокол передачи гипертекста (HTTP)

```shell-session
Barlogsha@htb[/htb]$ curl inlanefreight.com

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
...SNIP...
```

Мы видим, что cURL не отображает код HTML/JavaScript/CSS, в отличие от веб-браузера, а выводит его в исходном формате. Однако нас, специалистов по тестированию на проникновение, в первую очередь интересует контекст запроса и ответа, который обычно обрабатывается намного быстрее и удобнее, чем в веб-браузере.

Мы также можем использовать cURL для загрузки страницы или файла и вывода содержимого в файл с помощью флага `-O` . Если мы хотим указать имя выходного файла, мы можем использовать флаг `-o` и указать имя. В противном случае мы можем использовать `-O`, и cURL будет использовать имя удалённого файла следующим образом:

  Протокол передачи гипертекста (HTTP)

```shell-session
Barlogsha@htb[/htb]$ curl -O inlanefreight.com/index.html
Barlogsha@htb[/htb]$ ls
index.html
```

Как мы видим, на этот раз вывод не был напечатан, а был сохранён в `index.html`. Мы заметили, что cURL всё равно выводит некоторые статусы во время обработки запроса. Мы можем отключить вывод статусов с помощью флага `-s` следующим образом:

  Протокол передачи гипертекста (HTTP)

```shell-session
Barlogsha@htb[/htb]$ curl -s -O inlanefreight.com/index.html
```

На этот раз cURL ничего не вывел, так как результат был сохранён в файле `index.html` . Наконец, мы можем использовать флаг `-h` , чтобы узнать, какие ещё параметры можно использовать с cURL:

  Протокол передачи гипертекста (HTTP)

```shell-session
Barlogsha@htb[/htb]$ curl -h
Usage: curl [options...] <url>
 -d, --data <data>   HTTP POST data
 -h, --help <category> Get help for commands
 -i, --include       Include protocol response headers in the output
 -o, --output <file> Write to file instead of stdout
 -O, --remote-name   Write output to a file named as the remote file
 -s, --silent        Silent mode
 -u, --user <user:password> Server user and password
 -A, --user-agent <name> Send User-Agent <name> to server
 -v, --verbose       Make the operation more talkative

This is not the full help, this menu is stripped into categories.
Use "--help category" to get an overview of all categories.
Use the user manual `man curl` or the "--help all" flag for all options.
```

Как указано в сообщении выше, мы можем использовать `--help all` для вывода более подробного меню справки или `--help category` (например, `-h http`) для вывода подробной справки по конкретному флагу. Если нам понадобится более подробная документация, мы можем использовать `man curl` для просмотра полной страницы руководства по cURL.

В следующих разделах мы рассмотрим большинство вышеперечисленных флагов и узнаем, где следует использовать каждый из них.