#web #htb #php

Веб-приложения используют серверную часть [баз данных](https://en.wikipedia.org/wiki/Database) для хранения различного контента и информации, связанной с веб-приложением. Это могут быть основные ресурсы веб-приложения, такие как изображения и файлы, контент веб-приложения, например публикации и обновления, или пользовательские данные, например имена пользователей и пароли. Это позволяет веб-приложениям легко и быстро хранить и извлекать данные, а также создавать динамический контент, уникальный для каждого пользователя.

Существует множество различных типов баз данных, каждый из которых подходит для определённого типа использования. Большинство разработчиков обращают внимание на определённые характеристики базы данных, такие как `speed` при хранении и извлечении данных, `size` при хранении больших объёмов данных, `scalability` по мере роста веб-приложения и `cost`.

---

## Реляционные (SQL)

[Реляционные](https://en.wikipedia.org/wiki/Relational_database) (SQL) базы данных хранят данные в таблицах, строках и столбцах. Каждая таблица может иметь уникальные ключи, которые позволяют связывать таблицы между собой и создавать связи между ними.

Например, в реляционной базе данных может быть таблица `users` со столбцами `id`, `username`, `first_name`, `last_name` и так далее. Столбец `id` может использоваться в качестве ключа таблицы. Другая таблица, `posts`, может содержать публикации всех пользователей со столбцами `id`, `user_id`, `date`, `content` и так далее.

![[Pasted image 20251230140835.png]]

Мы можем связать `id` из таблицы `users` с `user_id` в таблице `posts`, чтобы легко получать данные о пользователях для каждого поста без необходимости хранить все данные о пользователях для каждого поста.

Таблица может иметь несколько ключей, поскольку другой столбец может использоваться в качестве ключа для связи с другой таблицей. Например, столбец `id` может использоваться в качестве ключа для связи таблицы `posts` с другой таблицей, содержащей комментарии, каждый из которых относится к определённому посту, и так далее.

Связь между таблицами в базе данных называется схемой.

Таким образом, благодаря использованию реляционных баз данных можно очень быстро и легко получить все данные об определённом элементе из всех баз данных. Например, мы можем получить все сведения, связанные с определённым пользователем, из всех таблиц с помощью одного запроса. Это делает реляционные базы данных очень быстрыми и надёжными для работы с большими наборами данных, имеющими чёткую структуру и дизайн. Базы данных также позволяют эффективно управлять данными.

К наиболее распространённым реляционным базам данных относятся:

|Тип|Описание|
|---|---|
|[MySQL](https://en.wikipedia.org/wiki/MySQL)|Самая популярная база данных в интернете. Это база данных с открытым исходным кодом, которую можно использовать совершенно бесплатно|
|[MSSQL](https://en.wikipedia.org/wiki/Microsoft_SQL_Server)|Реализация реляционной базы данных от Microsoft. Широко используется на серверах Windows и веб-серверах IIS|
|[Oracle](https://en.wikipedia.org/wiki/Oracle_Database)|Это очень надёжная база данных для крупного бизнеса, которая часто обновляется с помощью инновационных решений, повышающих её скорость и надёжность. Она может быть дорогостоящей даже для крупного бизнеса|
|[PostgreSQL](https://en.wikipedia.org/wiki/PostgreSQL)|Ещё одна бесплатная реляционная база данных с открытым исходным кодом. Она легко расширяется, что позволяет добавлять новые функции без существенного изменения первоначальной структуры базы данных|

К другим распространённым базам данных SQL относятся: `SQLite`, `MariaDB`, `Amazon Aurora`, `Azure SQL`.

---

## Нереляционные (NoSQL)

[Нереляционная база данных](https://en.wikipedia.org/wiki/NoSQL) не использует таблицы, строки, столбцы, первичные ключи, связи или схемы. Вместо этого `NoSQL` база данных хранит данные с использованием различных моделей хранения в зависимости от типа хранимых данных.

Из-за отсутствия определённой структуры базы данных `NoSQL`-базы данных отличаются высокой масштабируемостью и гибкостью. Если вы работаете с наборами данных, которые не очень хорошо определены и структурированы, `NoSQL`-база данных станет лучшим выбором для хранения ваших данных.

Существует 4 распространённые модели хранения данных для `NoSQL` баз данных:

- Ключ-значение
- На основе документов
- Широкая колонка
- График

Каждая из вышеперечисленных моделей хранит данные по-своему. Например, модель `Key-Value` обычно хранит данные в `JSON` или `XML` и имеет ключ для каждой пары, в котором хранятся все данные в виде значения:

![[Pasted image 20251230141234.png]]

Приведённый выше пример можно представить с помощью `JSON` следующим образом:

Код: json

```json
{
  "100001": {
    "date": "01-01-2021",
    "content": "Welcome to this web application."
  },
  "100002": {
    "date": "02-01-2021",
    "content": "This is the first post on this web app."
  },
  "100003": {
    "date": "02-01-2021",
    "content": "Reminder: Tomorrow is the ..."
  }
}
```

Это похоже на словарь/карту/пару «ключ-значение» в таких языках, как `Python` или `PHP` 'т. е. `{'key':'value'}`', где `key` обычно является строкой, а `value` может быть строкой, словарём или объектом любого класса.

Модель `Document-Based` хранит данные в сложных `JSON` объектах, и каждый объект содержит определённые метаданные, а остальные данные хранятся так же, как в модели `Key-Value` .

К числу наиболее распространённых `NoSQL` баз данных относятся:

| Тип                                                                | Описание                                                                                                                                                                                                                           |
| ------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [MongoDB](https://en.wikipedia.org/wiki/MongoDB)                   | Самая распространённая `NoSQL` база данных. Она бесплатная, с открытым исходным кодом, использует `Document-Based` модель и хранит данные в `JSON` объектах                                                                        |
| [ElasticSearch](https://en.wikipedia.org/wiki/Elasticsearch)       | Ещё одна бесплатная база данных с открытым исходным кодом `NoSQL` . Она оптимизирована для хранения и анализа огромных массивов данных. Как следует из названия, поиск данных в этой базе осуществляется очень быстро и эффективно |
| [Apache Cassandra](https://en.wikipedia.org/wiki/Apache_Cassandra) | Также бесплатно и с открытым исходным кодом. Он очень масштабируемый и оптимизирован для корректной обработки ошибочных значений                                                                                                   |

Другие распространенные `NoSQL` базы данных включают: `Redis`, `Neo4j`, `CouchDB` и `Amazon DynamoDB`.

---

## Использование в веб-приложениях

Большинство современных языков и фреймворков для веб-разработки упрощают интеграцию, хранение и извлечение данных из различных типов баз данных. Но сначала базу данных нужно установить и настроить на внутреннем сервере, и как только она будет запущена, веб-приложения смогут использовать ее для хранения и извлечения данных.

Например, в веб-приложении `PHP` после запуска `MySQL` мы можем подключиться к серверу базы данных с помощью:

Код: php

```php
$conn = new mysqli("localhost", "user", "pass");
```

Затем мы можем создать новую базу данных с помощью:

Код: php

```php
$sql = "CREATE DATABASE database1";
$conn->query($sql)
```

После этого мы можем подключиться к нашей новой базе данных и начать использовать базу данных `MySQL` с помощью синтаксиса `MySQL` прямо внутри `PHP`, следующим образом:

Код: php

```php
$conn = new mysqli("localhost", "user", "pass", "database1");
$query = "select * from table_1";
$result = $conn->query($query);
```

При получении данных веб-приложения обычно используют вводимые пользователем данные. Например, когда пользователь с помощью функции поиска находит других пользователей, его запрос передается веб-приложению, которое использует его для поиска в базе данных (базах данных).

Код: php

```php
$searchInput =  $_POST['findUser'];
$query = "select * from users where name like '%$searchInput%'";
$result = $conn->query($query);
```

Наконец, веб-приложение отправляет пользователю результат:

Код: php

```php
while($row = $result->fetch_assoc() ){
	echo $row["name"]."<br>";
}
```

Этот базовый пример показывает, насколько просто использовать базы данных. Однако при отсутствии надёжной защиты код базы данных может привести к различным проблемам, таким как [уязвимости, связанные с внедрением SQL-кода](https://owasp.org/www-community/attacks/SQL_Injection).