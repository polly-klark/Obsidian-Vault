#web #htb 

Если мы проводим тест на проникновение для внутреннего веб-приложения или не находим общедоступных эксплойтов для общедоступного веб-приложения, мы можем вручную выявить несколько уязвимостей. Мы также можем обнаружить уязвимости, вызванные неправильными настройками, даже в общедоступных веб-приложениях, поскольку такие уязвимости возникают не из-за общедоступной версии веб-приложения, а из-за неправильных настроек, сделанных разработчиками. Ниже приведены примеры наиболее распространённых типов уязвимостей для веб-приложений, которые входят в [OWASP Top 10](https://owasp.org/www-project-top-ten/) уязвимостей для веб-приложений.

---

## Нарушение аутентификации/контроля доступа

`Broken authentication` и `Broken Access Control` — одни из самых распространённых и опасных уязвимостей веб-приложений.

`Broken Authentication` Речь идёт об уязвимостях, которые позволяют злоумышленникам обходить функции аутентификации. Например, это может позволить злоумышленнику войти в систему без действительных учётных данных или сделать обычного пользователя администратором без соответствующих привилегий.

`Broken Access Control` Речь идёт об уязвимостях, которые позволяют злоумышленникам получать доступ к страницам и функциям, к которым у них не должно быть доступа. Например, обычный пользователь получает доступ к панели администратора.

Например, `College Management System 1.2` имеет простую уязвимость [Auth Bypass](https://www.exploit-db.com/exploits/47388), которая позволяет нам войти в систему без учётной записи, введя в поле для электронной почты следующее: `' or 0=0 #` и любой пароль.

---

## Загрузка вредоносных файлов

Ещё один распространённый способ получить контроль над веб-приложениями — загрузить вредоносные скрипты. Если в веб-приложении есть функция загрузки файлов и она не проверяет загружаемые файлы должным образом, мы можем загрузить вредоносный скрипт (например, `PHP`-скрипт), который позволит нам выполнять команды на удалённом сервере.

Несмотря на то, что это базовая уязвимость, многие разработчики не знают об этих угрозах и не проверяют должным образом загружаемые файлы. Более того, некоторые разработчики выполняют проверки и пытаются подтвердить подлинность загружаемых файлов, но эти проверки часто можно обойти, что всё равно позволит нам загружать вредоносные скрипты.

Например, плагин WordPress `Responsive Thumbnail Slider 1.0` можно использовать для загрузки любого произвольного файла, в том числе вредоносных скриптов, загрузив файл с двойным расширением (например, `shell.php.jpg`). Существует даже [модуль Metasploit](https://www.rapid7.com/db/modules/exploit/multi/http/wp_responsive_thumbnail_slider_upload/), который позволяет легко использовать эту уязвимость.

---

## Внедрение команд

Многие веб-приложения выполняют локальные команды операционной системы для реализации определенных процессов. Например, веб-приложение может установить выбранный нами плагин, выполнив команду ОС, которая загружает этот плагин, используя указанное имя плагина. Если не выполнить надлежащую фильтрацию и очистку, злоумышленники могут внедрить другую команду, которая будет выполнена вместе с изначально предназначенной командой (например, в качестве имени плагина), что позволит им напрямую выполнять команды на внутреннем сервере и получить контроль над ним. Этот тип уязвимости называется [внедрением команд](https://owasp.org/www-community/attacks/Command_Injection).

Эта уязвимость широко распространена, поскольку разработчики могут не обеспечивать должную очистку пользовательского ввода или использовать для этого слабые тесты, что позволяет злоумышленникам обходить любые проверки и фильтры и выполнять свои команды.

Например, в плагине WordPress `Plainview Activity Monitor 20161228` есть [уязвимость](https://www.exploit-db.com/exploits/45274), которая позволяет злоумышленникам внедрять свои команды в значение `ip`, просто добавляя `| COMMAND...` после значения `ip` .

---

## Внедрение SQL-кода (SQLi)

Еще одна очень распространенная уязвимость в веб-приложениях — это `SQL Injection` уязвимость. Как и в случае с внедрением команд, эта уязвимость может возникнуть, когда веб-приложение выполняет SQL-запрос, включающий значение, полученное от пользователя.

Например, в разделе `database` мы видели, как веб-приложение использует вводимые пользователем данные для поиска в определённой таблице с помощью следующей строки кода:

Код: php

```php
$query = "select * from users where name like '%$searchInput%'";
```

Если вводимые пользователем данные не фильтруются и не проверяются должным образом (как в случае с `Command Injections`), мы можем выполнить ещё один SQL-запрос параллельно с этим, что в конечном итоге позволит нам получить контроль над базой данных и сервером, на котором она размещена.

Например, тот же предыдущий `College Management System 1.2` страдает от SQL-инъекции [уязвимости](https://www.exploit-db.com/exploits/47388), с помощью которой мы можем выполнить другой `SQL` запрос, который всегда возвращает `true`, то есть мы успешно прошли аутентификацию, что позволяет нам войти в приложение. Мы можем использовать ту же уязвимость для получения данных из базы или даже для получения контроля над сервером хостинга.

Мы будем сталкиваться с этими уязвимостями снова и снова в процессе обучения и при оценке реальных ситуаций. Важно ознакомиться с каждой из них, поскольку даже базовое понимание каждой из них даст нам преимущество в любой сфере информационной безопасности. В последующих модулях мы подробно рассмотрим каждую из этих уязвимостей.