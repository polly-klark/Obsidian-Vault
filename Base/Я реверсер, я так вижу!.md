#LetoCTF #reverse 

# who am i

==Dmitry Sklyarov==

- занимаюсь Reverse Engineering с конца 1990-х
- ~~страдаю~~ наслаждаюсь потребностью понять, "как оно работает"
- ищу всё плохое, чтобы сделать его хорошии
- руковожу отделом анализа приложений

# откуда берутся ошибки

**ошибки** - прямое последствие борьбы за повышение эффективности

## эффективный программист

- ~~недорого стоит~~
- быстро пишет код
- решает поставленную задачу
- ~~легко читается и модифицируется~~
- ~~проходит все возможные тесты~~
- ~~требует мало ресов~~

**Хороший программист** должен писать ==достаточно большой== набор тестов для проверки кода

## качество не в приоритете

Бизнес-модель требует быстро вывести продукт на рынок

## только самое необходимое

Каждая доп проверка требует [ценного] времени программиста

## перфекционизм вреден

- чем больше unit-тестов ма напишем, тем больше времени потратим, и тем выше вероятность того, что один из тестов не будет пройден
- и вообще, инженеры-мостостроители не проверяют мост на устойчивость к вертикальному ветру

## не изобретать велосипед

Senior Developer - where did you get this part of code?
Junior Developer - from StackOverflow
Senior Developer - from the answers or the questions?

# как принято бороться с ошибками

## mitigation (смягчение)

действие по уменьшению тяжести, серьёзности или болезненности чего-либо

### способы смягчения ущерба

- Stack Canaries
- Data Execution Prevention (DEP)
- Address Space Layout Randomization (ASLR)
- Microsoft Control Flow Guard (CFG)
- Microsoft eXtended Flow Guard (XFG)
- Intel Control Flow Enforcement Technology (CET)
- ...

==на самом деле ошибки никуда не деваются==

## найти косяки программиста

- lint (since 1978)
- compiler warnings + safe API
- SAST/DAST/IAST/etc...
Static/Dynamic/Interactive/... Aplication Security Testing

*кусок программы проверяем на безопасность в момент выполнения*

## выбрать верный язык

- типизация построже
- возможно, managed
- максимально strict
- а то и функциональный...

==всё пишут на java==

*erlang*

*"Пионеры программирования"*

Питон классный язык, но ==не надо делать на нём продакшн==

В язык Питон *неочевидные* вещи не включают, а вот ==библиотеки== - пожалуйста

Работа с функциональными языками требует ==совершенно другого мышления==

*"Вы не понимаете, что вы делаете"*

## write-only языки

*"Расскажи, что здесь написано"*

**Три фишки ООП:**

- Полиморфизм
- Инкапсуляция
- Наследование

*Исходники* - не для ревёрсеров (нужны ==бинари==)

## полиморфизм это ... плохо?

прежде чем изучать **ООП**, надо изучить **ООП**!

**ООП** == объектно-ориентированное *программирование*

Если вы дописываете чужой код, у вас могут быть проблемы. Это порождает ошибки

## очень надёжные решения

- defensive programming (на каждый шаг проверка) *пример с мёртвым морем и отрицательным значением высоты для самолёта*
- secure coding ()
- secure execution

## безопасное выполнение

- три одинаковых решателя, ==большинство голосов==
- два решателя на разных архитектурах, проверяющих *один* набор правил *разными* алгоритмами, ==единогласно==

## моё знакомство с SSDLC

1987-1991, УПК №3 / УНТЦ "Юниор" (сейчас "Колледж автоматизации и ИТ")

**сначала надо рисовать блок-схемы, а потом писать программы!**

~1994, МГТУ, РК-9

**блок-схемы, полученные из кода, позволяют проверить ...**
# почему ошибки не исчезают

## хорошо, когда много ядер

==Многопоточность== - это проблема

*Multithreading Applications in Win32* - для многопоточности

## криптография нужна всем

## честное лицензирование

Подпись плагинов в Acrobat 4 SDK:

1. RSA-512
- можно факторизовать
2. подпись плагина считается от заголовков, но не от кода 
- можно исправить плагин и реализовать любой функционал
## исправление уязвимотей

**день/событие**

0 рапорт об уязвимости
7 безопасники вендора признали проблему и направили в разаработку
20 разработка сказала, что до конца текущего цикла нет времени отвечать
90 разработка сказала, что в новом цикле слишком длинный бэклог
180 разработка взялась за исправление
270 раработка выпустила исправление
271 вендор опубликовал security bulletin и патч
==366== большинство пользователей установили обновление

## а можно и не исправлять

- монополия (да куда ты денешься...)
- end-of-life (отстань, иди и купи новое)
- legal reason (а мы запрещаем reverse!)
- как здорово, что у вас Responsible Disclosure ;-)

## программист vs ревёрер

программист оперирует абстрактными сущностями 

ревёрсер мыслит в терминах конкретной исполняющей машины

## самая простая программа

~~~
unsigned int i;
i = 0;
i = i - 1;

// А это вообще законно?
~~~

## теория ошибок

**Указание начинающему программисту:**

Если бы вы не сделали ошибку, значит её сделал бы кто-то другой на другом уровне

## что может работать не так

- программа
- транлятор/компилятор/интерпретатор
- среда/библиотека исполнения
- ОС
- драйверы устройств (история про Калифорнию, 7 клиентов работают, подключают 8-го - сервер падает, проблема в драйвере клавиатуры, ошибка Microsoft)
- процессор
- ...

# как жить дальше

## а мне всё нравится ;)

- чем больше ошибок, тем проще моя работа
- пока есть ошибки, мне не будет скучно

## абстрактные идеи

- придётся жертвовать эффективностью бизнесов-роцессов
- одними технологиями проблему не решить
- придётся вкладываться в воспитание и культуру разработки

и участвовать в POSI{dev}