#LetoCTF #forensic 

# Что такое ФС?

## Способ организации данных

- FAT12/16/32
- exFAT
- NTFS
- и тд.
## Часть ОС

# Где живут ФС?

- Пользователи работают с файлами посредством компонент ОС
- Системные компоненты и криминалисты работают с различными моделями хранилищ данных

==В томах==

- Запрос на чтение из файла переходит в ядро ОС
- В ядре ОС запрос транслируется в запрос на чтение данных физических и виртуальных устройств

==Стэлс??==

*R.STUDIO Network??*
# Вернуться из "удалёнки"

- Данные храняться в кластерах
- Кластера не обязательно последовательные
- Информация о цепочке кластеров файла храниться в служебных структурах ФС и может пропасть при удалении файла

==Порядок кластеров==

- Было отмечено появление "артефакта" при неверном выборе кластера
- Наличие "артефакта" возможно определить методами ML

- Каждый пиксель изображения кодируется 6 признаков
- **X, Y** = кодируют положение пикселя на изображении
- **R, G, B** = настыщеность цвета 
- ...

- У цветов пограничных пикселей на границе определяем кластерную структуру
- Строим гистограммы распреда цветов по кластерам для восстановленного изображения и добавленного фрагмента
- Сравниваем гистограммы

## Статья про восстановление данных

https://habr.com/ru/companies/ntc-vulkan/articles/692818/

# Магия метаданных

==Символ изменения направлени каретки поменял направление чтения и за обычным txt спрятал vbs==

- имя
- время
- Доп потоки данных NTFS
- ...

- ФС FAT и NTFS хранит короткое и длинное имя 
- Данное имя храниться в Юникод
- Имя храниться в индексных записях и может дублироваться в др служебных струкутрах
- Символы в именах файлов, допустимые в одних ОС недоступны в других
- Существуют ...

## Метки времени

- ФС хранит несколько меток времени (4)
- Метки храняться в индексных записях и могут добавляться в др служебных структурах ФС
- В FAT метка вр последнего доступа позволяет хранить только дату
- ОС позволяет изменять метки вр (но не все)
- ...

- **Python:**  *os.utime(path, (access_time, modification_time))* 
- **Win32:** ...

## Дополнительные потоки данных

- Данные небольших файлов могут храниться в метаданных (...)
- Потоки данных могут иметь имя
- ОС считает содержимых ...
- ...

==если не влезло в кластер, то...==

==надо подтянуть потоки==

## Метаданные NTFS

- Служебные структуры NTFS хранится в виде файлов (метафайлов)
- Метафайлы не отображаются ОС 
- Файл или каталог можно сделать недоступным для пользователя 

https://github.com/mtivadar/windows10_ntfs_crash_dos/blob/master/ntfsimg/tinyntfs

*FAR Manager*
# Кому это нужно?

- Расследователям инцидентов безопасности (Security Operation Center)
- Экспертам-криминалистам
- Обычным юзерам
- Хакерам

# Выводы

- Уметь анализироват ФС важно
-
-
-