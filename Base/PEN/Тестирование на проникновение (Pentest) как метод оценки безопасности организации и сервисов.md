#pentest

**Тестирование на проникновение** – вид работ по выявлению уязвимостей, основанный на имитации действий потенциального нарушителя. Pentest выполняют внутренние эксперты кибербезопасности или сторонние организации, обладающие компетенциями в области проведения такого рода испытаний. Выполнение тестирования на проникновение разработчиками или специалистами по функциональному тестированию программного обеспечения нежелательно.

Согласно ГОСТ Р 58143-2018 «Информационная технология. Методы и средства обеспечения безопасности. Детализация анализа уязвимостей программного обеспечения в соответствии с ГОСТ Р ИСО/МЭК 15408 и ГОСТ Р ИСО/МЭК 18045. Часть 2. Тестирование проникновения» определяются следующие этапы проведения тестирования на проникновение:

-   планирование тестирования на проникновение;
-   разработка тестов;
-   проведение пентеста;
-   формирование отчетности по результатам тестирования на проникновение.

В зависимости от доступности информации об объекте исследования Pentest может проводиться одним из следующих методов:

-   метод черного ящика (black box) – без доступа об исследуемом объекте;
-   метод белого ящика (white box) – с полным доступом к информации об исследуемом объекте (архитектура, исходные коды, учетные записи);
-   метод серого ящика (gray box) – частичный доступ к информации об исследуемом объекте.

Помимо вышеуказанного стандарта для проведения тестирования на проникновение могут быть использованы следующие лучшие практики:

-   Penetration Testing Execution Standard (PTES);
-   Open Source Security Testing Methodology (OSSTM);
-   OWASP Testing Guide;
-   NIST Special Publication 800-115 «Technical Guide to Information Security Testing and Assessment».

Pentest проводится в отношении: разрабатываемых продуктов и сервисов (автоматизированные системы, хранилища данных, сетевое оборудование, серверы приложений), используемых в организации сторонних решений, а также систем безопасности.

Тестирование позволяет выявить уязвимости в инфраструктуре и автоматизированных системах, получить информацию для оценки возможного ущерба, а также рекомендации по устранению выявленных уязвимостей.

# Как провести полноценный Pentest. Этапы и способы

Для проведения тестирования на проникновение рекомендуется использовать одну из вышеназванных методологий (PTES, OSSTM, OWASP Testing Guide, NIST Special Publication 800-115).

## 1. Этапы тестирования

В общем виде этапы тестирования на проникновение аналогичны этапам проведения атак злоумышленников:

-   подготовка к проведению тестирования;
-   рекогносцировка;
-   выбор вектора атаки;
-   эксплуатация и дальнейшее продвижение.

**Рекогносцировка** – сбор информации об исследуемой инфраструктуре, идентификация доступных сервисов и защитных механизмов. На этом этапе выполняются мероприятия по получению дополнительной информации об исследуемом объекте, используемом программном обеспечении, доступных сервисах, их версии.

На данном этапе проводится:

Внешний сбор данных:

-   сбор данных о доступных подсетях, ip-адресах;
-   проведение пассивной разведки (WHOIS, BGP).

Активная рекогносцировка:

-   сканирование портов;
-   SNMP и DNS сканирование;
-   обнаружение web-приложений;
-   сбор данных о средствах защиты;
-   составление списка целей.

**Выбор вектора атак** – определение возможности эксплуатации уязвимостей и выбор вектора атак на основании:

-   информации из общедоступных источников;
-   существования уязвимостей (PoC, exploits);
-   наличия слабых, словарных или часто используемых паролей;
-   наличия уязвимостей сетевого оборудования (по информации от вендоров);
-   наличия уязвимостей по списку OWASP Top 10.

На данном этапе проводится:

-   пассивное тестирование с целью проверки существования уязвимостей и планирования атак с их использованием;
-   активное тестирование на уровне сети или приложения.

**Эксплуатация и дальнейшее продвижение** – получение доступа к объекту исследования на основе полученной на предыдущих этапах информации.

На данном этапе проводится:

-   повышение привилегий;
-   сбор информации для идентификации и поиска новых возможностей получения доступа к иным системам;
-   установка дополнительных средств с целью сбора информации или дальнейшего продвижения.

На заключительном этапе тестирования готовится отчет, содержащий результаты проведенных работ. Он включает информацию для бизнес-подразделений и ИТ/КБ-специалистов (подробное описание обнаруженных уязвимостей, их критичность и рекомендации по устранению).

## 2. Способы тестирования

Тестирование на проникновение направлено на поиск и эксплуатацию уязвимостей – недостатков программного (программно-технического) средства или информационной системы в целом, которые могут быть использованы для реализации угроз безопасности информации. К рассматриваемым в рамках тестирования ошибкам относятся сетевые уязвимости, уязвимости конечных точек и уязвимости web-приложений.

# Сетевые уязвимости

Сетевые атаки можно сопоставить с моделями OSI и TCP/IP. Данное представление приведено в Таблице 1.

![[Pasted image 20230114205132.png]]

# Уязвимости на конечные точки

Данные уязвимости можно разделить на описанные ниже категории.

**Уязвимости конфигурации** – появляются при настройке ПО, вызваны необходимостью кастомизации, упрощения, а также пиратством или ленью:

-   пароли в скриптах;
-   отсутствие аутентификации сервисов;
-   несоответствие прав доступа;
-   необновленное ПО.

**Уязвимости кода** – появляются в процессе разработки или обновления ПО:

-   намеренные (бэкдоры) и непреднамеренные (ошибки программистов);
-   хардкод критических данных;
-   тестовый функционал.

**Уязвимости архитектуры** – появляются на этапе проектирования системы:

-   отсутствие встроенных механизмов защиты;
-   недостаточный контроль над компонентами системы (отсутствие защиты при работе по незащищенным каналам связи);
-   использование недоверенных носителей и устройств ввода-вывода информации.

**Организационные уязвимости** – появляются при недостаточных организационных мерах защиты системы:

-   неправильное распределение прав пользователей;
-   нарушение режима СКУД;
-   атаки через инфраструктуру подрядчиков.

# Уязвимости и атаки на веб-приложения

Наиболее известной классификацией уязвимостей веб-приложений является OWASP Top-10. В актуальной версии классификации 2021 года определен следующий перечень уязвимостей:

-   A01. Недостатки контроля доступа;
-   A02. Криптографические недостатки;
-   A03. Инъекции;
-   A04. Небезопасный дизайн;
-   A05. Небезопасная конфигурация;
-   A06. Использование уязвимых и устаревших компонентов;
-   A07. Недостатки идентификации и аутентификации;
-   A08. Нарушение целостности данных и программного обеспечения;
-   A09. Недостатки регистрации и мониторинга безопасности;
-   A10. Подделка запросов на стороне сервера.

Тестирование на проникновение, проведенное с использованием лучших практик, позволяет эффективно оценить безопасность объекта защиты и его элементов. Это подтверждается требованиями регуляторов о проведении данного вида тестирования в области критической информационной инфраструктуры, переводов денежных средств, PCI DSS.