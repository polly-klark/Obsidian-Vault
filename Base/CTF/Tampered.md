#forensic #writeup 

> Наш репозиторий флагов MAPNA был взломан, злоумышленники ввели один недействительный флаг. Можете ли вы идентифицировать поддельный флаг? Примечание: Забыли формат флага на страницах правил, просто найдите измененный. Вам не разрешается принудительно устанавливать флажок на табло, это приведет к блокировке вашей команды.

Просматривая данные файлы, мы получаем очень длинный список флагов.

Базовое сканирование не показывает ничего необычного по формату или длине флага, поэтому я просматриваю новые строки после каждого флага.

Я пишу базовый скрипт для разделения всех строк по общему окончанию `\r\r\n` и, если какая-либо из строк не соответствует ожидаемой длине, для их печати.

```
with open('flags.txt','rb') as f:
    d=f.read().split(b'\r\r\n')
    for x in d:
        if x != b'':
            if len(x) != 47:
                print(x)
```

```
$ python3 check.py
b'MAPNA{Tx,D51otN\\eUf7qQ7>ToSYQ\\;5P6jTIHH#6TL+uv}\r\n\rMAPNA{R6Z@//\\>caZ%%k)=ci3$IyOkSGK%w<"V7kgesY&k}’
```

Мы видим, что один флаг заканчивается на `\r\n\r`, который является нашим неуместным флагом.

Флаг: ==MAPNA{Tx,D51otN\\eUf7qQ7>ToSYQ\\;5P6jTIHH#6TL+uv}==