#forensic #writeup #wireshark 

> После тщательного расследования команда криминалистов MAPNA обнаружила, что злоумышленники пытались манипулировать временем ПЛК. Пожалуйста, укажите точное время в следующем формате: год: месяц: день: час: минута: секунда: миллисекунда. Флаг - MAPNA{sha256 (дата-время)}.

Изучая данные внутри пакетов, мы видим, что первые два пакета начинаются с `03000016`. Я посмотрел это на GitHub и нашел несколько [скриптов](https://github.com/tijldeneut/ICSSecurityScripts/blob/03cf22205e11629cdee661d87d969176b409abc6/SiemensScan.py#L562).

Это привело меня к [S7comm](https://wiki.wireshark.org/S7comm), и в разделе примеров был [пример настройки времени трафика](https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/s7comm_reading_setting_plc_time.pcap).

Я сравниваю необработанный TCP для примера трафика с заданным трафиком, и только 1 строка не похожа.

Часть данных примера, которая отличалась (`00191408201159330400`), является датой, проанализированной в парсинге Wiresharks S7comm.

![[Pasted image 20240825223552.png]]

Просматривая наш файл, мы видим, `00202309211959299490` который можно разобрать на `2023:09:21:19:59:29:949`.

Сумма SHA256 из этого дает нам наш флаг.

Флаг: ==MAPNA{9effd248efdf066cf432a21a34d87db56d0d0a7e4fe9bb3af6ef6f125fc36cfa}==

