#forensic #writeup #macro

![[Pasted image 20240826111141.png]]

–£ –Ω–∞—Å –µ—Å—Ç—å —ç—Ç–∏ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞: —Ñ–∞–π–ª .ad1 –∏ —Ñ–∞–π–ª –¥–∞–º–ø–∞ –ø–∞–º—è—Ç–∏.¬†–ò–∑ –æ–ø–∏—Å–∞–Ω–∏—è —è –ø–æ–Ω—è–ª, —á—Ç–æ –≤—Å–µ –≤–æ–∑–Ω–∏–∫—à–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º Word.¬†–ù–µ –¥–æ–∂–∏–¥–∞—è—Å—å, —è –æ—Ç–∫—Ä—ã–ª —Ñ–∞–π–ª ad1 —Å –ø–æ–º–æ—â—å—é¬†**7-zip**, –∏ –ø–æ—Å–∫–æ–ª—å–∫—É —è —Ä–µ—à–∏–ª –µ–≥–æ —É—Ç—Ä–æ–º, —É –º–µ–Ω—è —Ç–∞–∫ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–∏—Å–∫ –≤ –∫–∞–∂–¥–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ üòä.¬†–ü–æ—Å–ª–µ –¥–æ–ª–≥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞–∫–æ–Ω–µ—Ü, —è –æ–±–Ω–∞—Ä—É–∂–∏–ª, —á—Ç–æ —Ñ–∞–π–ª –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ —Å—Ç—Ä–∞–Ω–Ω–æ –≤¬†\ Roaming\ Microsoft \Templates:

![[Pasted image 20240826112537.png]]

–° –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ Word —Ö–∞–∫–µ—Ä –º–æ–∂–µ—Ç –≤—Å—Ç–∞–≤–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ¬†[–º–∞–∫—Ä–æ—Å—ã](https://knowadays.com/blog/what-is-a-macro-in-microsoft-word/), –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∞–¥—É—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ü–µ–ª–µ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.¬†–í Linux —É –Ω–∞—Å –µ—Å—Ç—å¬†**olevba**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ Word.¬†–ò —Ç–æ, —á—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏, - —ç—Ç–æ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π –∫–æ–¥ (–≤—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å —Å–∞–º–∏).¬†–ò –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤ —ç—Ç–æ—Ç –∫–æ–¥ –≤–∫–ª—é—á–µ–Ω—ã IP: port –∏ —Ñ—É–Ω–∫—Ü–∏—è —Å –∏–º–µ–Ω–µ–º¬†**revshell()**, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å 172.20.25.15:4444.¬†–ò—Ç–∞–∫, –º—ã –º–æ–∂–µ–º —Ä–µ—à–∏—Ç—å, —á—Ç–æ —ç—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –∫–æ–º–∞–Ω–¥–æ–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.  

–ï—Å–ª–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è, –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞–Ω–Ω—É—é –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É:  
**vmxjd2vfnuhsa2rqukzwvfzrwndtmvz0zuhku1jswlhwrmhvldgnlzrbfdsm2hqvkd4r1zvmuvheja9**.¬†–ü–æ –º–æ–µ–º—É –æ–ø—ã—Ç—É, –≤–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ base64, –∫–æ—Ç–æ—Ä—É—é –ø—ã—Ç–∞—é—Ç—Å—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å, –∏ —è –ø—Ä–∞–≤, –Ω–æ –º–Ω–µ –Ω—É–∂–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑, –∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –≤—Ç–æ—Ä–æ–π —Ñ–ª–∞–≥:

![[Pasted image 20240826125548.png]]

![[Pasted image 20240826130032.png]]
–ö–∞–∫ –Ω–∞—Å—á–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–ª–∞–≥–∞?¬†–ß—Ç–æ –∂, –Ω–∞–º –Ω—É–∂–Ω–æ –µ—â–µ —Ä–∞–∑ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ: —á–µ–ª–æ–≤–µ–∫ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ TetCTF, –æ–Ω —á–∏—Ç–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç Word, –∞ –∑–∞—Ç–µ–º –Ω–∞ –µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –≤–æ–ø—Ä–æ—Å–µ –æ–Ω–∏ –ø—Ä–æ—Å—è—Ç –≤–∞—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ TetCTF, –∞ –Ω–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –Ω–∞ –∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä.¬†–ü–æ–¥—É–º–∞–≤, —è —Ä–µ—à–∏–ª –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é –±—Ä–∞—É–∑–µ—Ä–∞.¬†–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —ç—Ç—É¬†[—Å—Ç—Ä–∞–Ω–∏—Ü—É](https://www.inversecos.com/2022/10/recovering-cleared-browser-history.html), –º—ã –º–æ–∂–µ–º —Å–æ–±—Ä–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —Ñ–∞–π–ª–∞–º, –∑–∞–ø—É—â–µ–Ω–Ω—ã–º —Å¬†**—Å–µ–∞–Ω—Å–∞**¬†–∏–ª–∏¬†**–≤–∫–ª–∞–¥–∫–∏**¬†–≤¬†**C:\Users <name>\AppData\Local\Google\Chrome\User Data\Default\Sessions**.¬†–û—Ç—Å—é–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞: –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å volatility –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å .ad1 —Ñ–∞–π–ª –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è.¬†–ü—Ä–æ—á–∏—Ç–∞–ª —Ñ–∞–π–ª Session ..., —è –Ω–∞—à–µ–ª –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–ª–∞–≥ üòä (—è –Ω–µ –∑–Ω–∞—é, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ–ø—Ä–µ–¥–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–º –∏–ª–∏ –Ω–µ—Ç).